/*! For license information please see 259.ac929a45.chunk.js.LICENSE.txt */
(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[259],{1469:function(t,e,n){"use strict";n.r(e),n.d(e,"AggregateField",(function(){return Nn})),n.d(e,"AggregateQuerySnapshot",(function(){return qn})),n.d(e,"Bytes",(function(){return zn})),n.d(e,"CollectionReference",(function(){return Rn})),n.d(e,"DocumentReference",(function(){return xn})),n.d(e,"DocumentSnapshot",(function(){return kr})),n.d(e,"FieldPath",(function(){return Qn})),n.d(e,"FieldValue",(function(){return Gn})),n.d(e,"Firestore",(function(){return An})),n.d(e,"FirestoreError",(function(){return K})),n.d(e,"GeoPoint",(function(){return Wn})),n.d(e,"Query",(function(){return Pn})),n.d(e,"QueryCompositeFilterConstraint",(function(){return Fr})),n.d(e,"QueryConstraint",(function(){return Er})),n.d(e,"QueryDocumentSnapshot",(function(){return wr})),n.d(e,"QueryEndAtConstraint",(function(){return Ur})),n.d(e,"QueryFieldFilterConstraint",(function(){return Ar})),n.d(e,"QueryLimitConstraint",(function(){return xr})),n.d(e,"QueryOrderByConstraint",(function(){return Nr})),n.d(e,"QuerySnapshot",(function(){return Or})),n.d(e,"QueryStartAtConstraint",(function(){return Cr})),n.d(e,"Timestamp",(function(){return Pt})),n.d(e,"Transaction",(function(){return Ei})),n.d(e,"WriteBatch",(function(){return pi})),n.d(e,"addDoc",(function(){return ri})),n.d(e,"aggregateFieldEqual",(function(){return ci})),n.d(e,"aggregateQuerySnapshotEqual",(function(){return li})),n.d(e,"and",(function(){return Dr})),n.d(e,"arrayRemove",(function(){return vi})),n.d(e,"arrayUnion",(function(){return di})),n.d(e,"average",(function(){return oi})),n.d(e,"collection",(function(){return Cn})),n.d(e,"collectionGroup",(function(){return Ln})),n.d(e,"connectFirestoreEmulator",(function(){return Vn})),n.d(e,"count",(function(){return si})),n.d(e,"deleteDoc",(function(){return ni})),n.d(e,"deleteField",(function(){return fi})),n.d(e,"doc",(function(){return Mn})),n.d(e,"documentId",(function(){return Kn})),n.d(e,"endAt",(function(){return zr})),n.d(e,"endBefore",(function(){return Br})),n.d(e,"getAggregate",(function(){return ai})),n.d(e,"getCount",(function(){return ii})),n.d(e,"getDoc",(function(){return $r})),n.d(e,"getDocs",(function(){return Zr})),n.d(e,"getFirestore",(function(){return Fn})),n.d(e,"increment",(function(){return yi})),n.d(e,"initializeFirestore",(function(){return In})),n.d(e,"limit",(function(){return Pr})),n.d(e,"limitToLast",(function(){return Rr})),n.d(e,"or",(function(){return Vr})),n.d(e,"orderBy",(function(){return qr})),n.d(e,"query",(function(){return Sr})),n.d(e,"queryEqual",(function(){return Bn})),n.d(e,"refEqual",(function(){return Un})),n.d(e,"runTransaction",(function(){return Si})),n.d(e,"serverTimestamp",(function(){return hi})),n.d(e,"setDoc",(function(){return ti})),n.d(e,"setLogLevel",(function(){return j})),n.d(e,"snapshotEqual",(function(){return jr})),n.d(e,"startAfter",(function(){return Mr})),n.d(e,"startAt",(function(){return Lr})),n.d(e,"sum",(function(){return ui})),n.d(e,"terminate",(function(){return Dn})),n.d(e,"updateDoc",(function(){return ei})),n.d(e,"where",(function(){return Ir})),n.d(e,"writeBatch",(function(){return gi}));var r=n(273),i=n(239),a=n(304),u=n(17),o=n(30),s=n(409),c=n(1),l=n(4),f=n(65),h=n(66),d=n(43),v=n(24),y=n(25),p=n(405),m=n(645),g=n(646),b=n(347),k=function(){function t(e){Object(v.a)(this,t),this.uid=e}return Object(y.a)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(t){return t.uid===this.uid}}]),t}();k.UNAUTHENTICATED=new k(null),k.GOOGLE_CREDENTIALS=new k("google-credentials-uid"),k.FIRST_PARTY=new k("first-party-uid"),k.MOCK_USER=new k("mock-user");var w="9.23.0",O=new g.b("@firebase/firestore");function j(t){O.setLogLevel(t)}function _(t){if(O.logLevel<=g.a.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(S);O.debug.apply(O,["Firestore (".concat(w,"): ").concat(t)].concat(Object(d.a)(i)))}}function T(t){if(O.logLevel<=g.a.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(S);O.error.apply(O,["Firestore (".concat(w,"): ").concat(t)].concat(Object(d.a)(i)))}}function E(t){if(O.logLevel<=g.a.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n.map(S);O.warn.apply(O,["Firestore (".concat(w,"): ").concat(t)].concat(Object(d.a)(i)))}}function S(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",e="FIRESTORE (".concat(w,") INTERNAL ASSERTION FAILED: ")+t;throw T(e),new Error(e)}function I(t,e){t||A()}function F(t,e){return t}var V="cancelled",D="unknown",N="invalid-argument",q="deadline-exceeded",x="not-found",P="permission-denied",R="unauthenticated",C="resource-exhausted",L="failed-precondition",M="aborted",U="out-of-range",B="unimplemented",z="internal",Q="unavailable",K=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,r)).code=t,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return Object(y.a)(n)}(b.c),G=Object(y.a)((function t(){var e=this;Object(v.a)(this,t),this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))})),W=Object(y.a)((function t(e,n){Object(v.a)(this,t),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))})),Y=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(k.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),H=function(){function t(e){Object(v.a)(this,t),this.token=e,this.changeListener=null}return Object(y.a)(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),J=function(){function t(e){var n=this;Object(v.a)(this,t),this.auth=null,e.onInit((function(t){n.auth=t}))}return Object(y.a)(t,[{key:"getToken",value:function(){var t=this;return this.auth?this.auth.getToken().then((function(e){return e?(I("string"==typeof e.accessToken),new W(e.accessToken,new k(t.auth.getUid()))):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){}},{key:"shutdown",value:function(){}}]),t}(),X=function(){function t(e,n,r){Object(v.a)(this,t),this.t=e,this.i=n,this.o=r,this.type="FirstParty",this.user=k.FIRST_PARTY,this.u=new Map}return Object(y.a)(t,[{key:"h",value:function(){return this.o?this.o():null}},{key:"headers",get:function(){this.u.set("X-Goog-AuthUser",this.t);var t=this.h();return t&&this.u.set("Authorization",t),this.i&&this.u.set("X-Goog-Iam-Authorization-Token",this.i),this.u}}]),t}(),$=function(){function t(e,n,r){Object(v.a)(this,t),this.t=e,this.i=n,this.o=r}return Object(y.a)(t,[{key:"getToken",value:function(){return Promise.resolve(new X(this.t,this.i,this.o))}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(k.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),Z=Object(y.a)((function t(e){Object(v.a)(this,t),this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),tt=function(){function t(e){var n=this;Object(v.a)(this,t),this.l=e,this.appCheck=null,e.onInit((function(t){n.appCheck=t}))}return Object(y.a)(t,[{key:"getToken",value:function(){return this.appCheck?this.appCheck.getToken().then((function(t){return t?(I("string"==typeof t.token),new Z(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){}},{key:"shutdown",value:function(){}}]),t}(),et=Object(y.a)((function t(e,n,r,i,a,u,o,s,c){Object(v.a)(this,t),this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c})),nt=function(){function t(e,n){Object(v.a)(this,t),this.projectId=e,this.database=n||"(default)"}return Object(y.a)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}(),rt=function(){function t(e,n,r){Object(v.a)(this,t),void 0===n?n=0:n>e.length&&A(),void 0===r?r=e.length-n:r>e.length-n&&A(),this.segments=e,this.offset=n,this.len=r}return Object(y.a)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(t){return this.segments[this.offset+t]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"isImmediateParentOf",value:function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"forEach",value:function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),a=e.get(r);if(i<a)return-1;if(i>a)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}]),t}(),it=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"construct",value:function(t,e,r){return new n(t,e,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=[],e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];for(var a=0,u=r;a<u.length;a++){var o=u[a];if(o.indexOf("//")>=0)throw new K(N,"Invalid segment (".concat(o,"). Paths must not contain // in them."));t.push.apply(t,Object(d.a)(o.split("/").filter((function(t){return t.length>0}))))}return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(rt),at=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ut=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"construct",value:function(t,e,r){return new n(t,e,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(t){return at.test(t)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(t){for(var e=[],r="",i=0,a=function(){if(0===r.length)throw new K(N,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(r),r=""},u=!1;i<t.length;){var o=t[i];if("\\"===o){if(i+1===t.length)throw new K(N,"Path has trailing escape character: "+t);var s=t[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new K(N,"Path has invalid escape sequence: "+t);r+=s,i+=2}else"`"===o?(u=!u,i++):"."!==o||u?(r+=o,i++):(a(),i++)}if(a(),u)throw new K(N,"Unterminated ` in path: "+t);return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(rt),ot=function(){function t(e){Object(v.a)(this,t),this.path=e}return Object(y.a)(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(t){return null!==t&&0===it.comparator(this.path,t.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(it.fromString(e))}},{key:"fromName",value:function(e){return new t(it.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(it.emptyPath())}},{key:"comparator",value:function(t,e){return it.comparator(t.path,e.path)}},{key:"isDocumentKey",value:function(t){return t.length%2==0}},{key:"fromSegments",value:function(e){return new t(new it(e.slice()))}}]),t}();function st(t,e,n){if(!n)throw new K(N,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function ct(t){if(!ot.isDocumentKey(t))throw new K(N,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function lt(t){if(ot.isDocumentKey(t))throw new K(N,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function ft(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}return"function"==typeof t?"a function":A()}function ht(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(N,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ft(t);throw new K(N,"Expected type '".concat(e.name,"', but it was: ").concat(n))}return t}function dt(t,e){if(e<=0)throw new K(N,"Function ".concat(t,"() requires a positive number, but it was: ").concat(e,"."))}function vt(t){var e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}var yt=null;function pt(t){return null==t}function mt(t){return 0===t&&1/t==-1/0}var gt,bt,kt={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};function wt(t){if(void 0===t)return T("RPC_ERROR","HTTP error has no status"),D;switch(t){case 200:return"ok";case 400:return L;case 401:return R;case 403:return P;case 404:return x;case 409:return M;case 416:return U;case 429:return C;case 499:return V;case 500:return D;case 501:return B;case 503:return Q;case 504:return q;default:return t>=200&&t<300?"ok":t>=400&&t<500?L:t>=500&&t<600?z:D}}(bt=gt||(gt={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";var Ot=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t)).P=r,i}return Object(y.a)(n,[{key:"V",value:function(t,e){throw new Error("Not supported by FetchConnection")}},{key:"A",value:function(){var t=Object(l.a)(Object(c.a)().mark((function t(e,n,r,i){var a,u,o,s,l,f;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=JSON.stringify(i),t.prev=1,t.next=4,this.P(n,{method:"POST",headers:r,body:u});case 4:o=t.sent,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),s=t.t0,new K(wt(s.status),"Request failed with error: "+s.statusText);case 11:if(o.ok){t.next=18;break}return t.next=14,o.json();case 14:throw l=t.sent,Array.isArray(l)&&(l=l[0]),f=null===(a=null==l?void 0:l.error)||void 0===a?void 0:a.message,new K(wt(o.status),"Request failed with error: ".concat(null!=f?f:o.statusText));case 18:return t.abrupt("return",o.json());case 19:case"end":return t.stop()}}),t,this,[[1,7]])})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),n}(function(){function t(e){Object(v.a)(this,t),this.databaseInfo=e,this.databaseId=e.databaseId;var n=e.ssl?"https":"http";this.m=n+"://"+e.host,this.p="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Object(y.a)(t,[{key:"g",get:function(){return!1}},{key:"v",value:function(t,e,n,r,i){var a=(null===yt?yt=268435456+Math.round(2147483648*Math.random()):yt++,"0x"+yt.toString(16)),u=this.I(t,e);_("RestConnection","Sending RPC '".concat(t,"' ").concat(a,":"),u,n);var o={};return this.T(o,r,i),this.A(t,u,o,n).then((function(e){return _("RestConnection","Received RPC '".concat(t,"' ").concat(a,": "),e),e}),(function(e){throw E("RestConnection","RPC '".concat(t,"' ").concat(a," failed with error: "),e,"url: ",u,"request:",n),e}))}},{key:"R",value:function(t,e,n,r,i,a){return this.v(t,e,n,r,i)}},{key:"T",value:function(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+w,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((function(e,n){return t[n]=e})),n&&n.headers.forEach((function(e,n){return t[n]=e}))}},{key:"I",value:function(t,e){var n=kt[t];return"".concat(this.m,"/v1/").concat(e,":").concat(n)}}]),t}()),jt=Object(y.a)((function t(e,n,r){Object(v.a)(this,t),this.alias=e,this.$=n,this.fieldPath=r}));function _t(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Tt=function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,null,[{key:"N",value:function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(256/62),n="";n.length<20;)for(var r=_t(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%62));return n}}]),t}();function Et(t,e){return t<e?-1:t>e?1:0}function St(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function At(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function It(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}var Ft=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(v.a)(this,n),(t=e.apply(this,arguments)).name="Base64DecodeError",t}return Object(y.a)(n)}(Object(s.a)(Error)),Vt=function(t){function e(t){Object(v.a)(this,e),this.binaryString=t}return Object(y.a)(e,[{key:t,value:function(){var t=this,e=0;return{next:function(){return e<t.binaryString.length?{value:t.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return t=this.binaryString,btoa(t);var t}},{key:"toUint8Array",value:function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(t){return Et(this.binaryString,t.binaryString)}},{key:"isEqual",value:function(t){return this.binaryString===t.binaryString}}],[{key:"fromBase64String",value:function(t){var n=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Ft("Invalid base64 string: "+t):t}}(t);return new e(n)}},{key:"fromUint8Array",value:function(t){var n=function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new e(n)}}]),e}(Symbol.iterator);Vt.EMPTY_BYTE_STRING=new Vt("");var Dt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nt(t){if(I(!!t),"string"==typeof t){var e=0,n=Dt.exec(t);if(I(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qt(t.seconds),nanos:qt(t.nanos)}}function qt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xt(t){return"string"==typeof t?Vt.fromBase64String(t):Vt.fromUint8Array(t)}var Pt=function(){function t(e,n){if(Object(v.a)(this,t),this.seconds=e,this.nanoseconds=n,n<0)throw new K(N,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(N,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new K(N,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(N,"Timestamp seconds out of range: "+e)}return Object(y.a)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(t){return this.seconds===t.seconds?Et(this.nanoseconds,t.nanoseconds):Et(this.seconds,t.seconds)}},{key:"isEqual",value:function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}();function Rt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ct(t){var e=t.mapValue.fields.__previous_value__;return Rt(e)?Ct(e):e}function Lt(t){var e=Nt(t.mapValue.fields.__local_write_time__.timestampValue);return new Pt(e.seconds,e.nanos)}var Mt={fields:{__type__:{stringValue:"__max__"}}};function Ut(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rt(t)?4:function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}(t)?9007199254740991:10:A()}function Bt(t,e){if(t===e)return!0;var n=Ut(t);if(n!==Ut(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lt(t).isEqual(Lt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Nt(t.timestampValue),r=Nt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return xt(t.bytesValue).isEqual(xt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return qt(t.geoPointValue.latitude)===qt(e.geoPointValue.latitude)&&qt(t.geoPointValue.longitude)===qt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return qt(t.integerValue)===qt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=qt(t.doubleValue),r=qt(e.doubleValue);return n===r?mt(n)===mt(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return St(t.arrayValue.values||[],e.arrayValue.values||[],Bt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(At(n)!==At(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Bt(n[i],r[i])))return!1;return!0}(t,e);default:return A()}}function zt(t,e){return void 0!==(t.values||[]).find((function(t){return Bt(t,e)}))}function Qt(t,e){if(t===e)return 0;var n=Ut(t),r=Ut(e);if(n!==r)return Et(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Et(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=qt(t.integerValue||t.doubleValue),r=qt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Kt(t.timestampValue,e.timestampValue);case 4:return Kt(Lt(t),Lt(e));case 5:return Et(t.stringValue,e.stringValue);case 6:return function(t,e){var n=xt(t),r=xt(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Et(n[i],r[i]);if(0!==a)return a}return Et(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Et(qt(t.latitude),qt(e.latitude));return 0!==n?n:Et(qt(t.longitude),qt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var a=Qt(n[i],r[i]);if(a)return a}return Et(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Mt&&e===Mt)return 0;if(t===Mt)return 1;if(e===Mt)return-1;var n=t.fields||{},r=Object.keys(n),i=e.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var u=0;u<r.length&&u<a.length;++u){var o=Et(r[u],a[u]);if(0!==o)return o;var s=Qt(n[r[u]],i[a[u]]);if(0!==s)return s}return Et(r.length,a.length)}(t.mapValue,e.mapValue);default:throw A()}}function Kt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Et(t,e);var n=Nt(t),r=Nt(e),i=Et(n.seconds,r.seconds);return 0!==i?i:Et(n.nanos,r.nanos)}function Gt(t,e){return{referenceValue:"projects/".concat(t.projectId,"/databases/").concat(t.database,"/documents/").concat(e.path.canonicalString())}}function Wt(t){return!!t&&"arrayValue"in t}function Yt(t){return!!t&&"nullValue"in t}function Ht(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jt(t){return!!t&&"mapValue"in t}function Xt(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return It(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Xt(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Xt(t.arrayValue.values[r]);return n}return Object.assign({},t)}var $t=Object(y.a)((function t(e,n){Object(v.a)(this,t),this.position=e,this.inclusive=n}));function Zt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Bt(t.position[n],e.position[n]))return!1;return!0}var te=Object(y.a)((function t(){Object(v.a)(this,t)})),ee=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).field=t,a.op=r,a.value=i,a}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Qt(e,this.value)):null!==e&&Ut(this.value)===Ut(e)&&this.matchesComparison(Qt(e,this.value))}},{key:"matchesComparison",value:function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return A()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,r):new ie(t,e,r):"array-contains"===e?new se(t,r):"in"===e?new ce(t,r):"not-in"===e?new le(t,r):"array-contains-any"===e?new fe(t,r):new n(t,e,r)}},{key:"createKeyFieldInFilter",value:function(t,e,n){return"in"===e?new ae(t,n):new ue(t,n)}}]),n}(te),ne=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).filters=t,i.op=r,i.D=null,i}return Object(y.a)(n,[{key:"matches",value:function(t){return"and"===this.op?void 0===this.filters.find((function(e){return!e.matches(t)})):void 0!==this.filters.find((function(e){return e.matches(t)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.D||(this.D=this.filters.reduce((function(t,e){return t.concat(e.getFlattenedFilters())}),[])),this.D}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var t=this.F((function(t){return t.isInequality()}));return null!==t?t.field:null}},{key:"F",value:function(t){var e,n=Object(o.a)(this.getFlattenedFilters());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(t,e){return new n(t,e)}}]),n}(te);function re(t,e){return t instanceof ee?function(t,e){return e instanceof ee&&t.op===e.op&&t.field.isEqual(e.field)&&Bt(t.value,e.value)}(t,e):t instanceof ne?function(t,e){return e instanceof ne&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((function(t,n,r){return t&&re(n,e.filters[r])}),!0)}(t,e):void A()}var ie=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this,t,r,i)).key=ot.fromName(i.referenceValue),a}return Object(y.a)(n,[{key:"matches",value:function(t){var e=ot.comparator(t.key,this.key);return this.matchesComparison(e)}}]),n}(ee),ae=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,"in",r)).keys=oe("in",r),i}return Object(y.a)(n,[{key:"matches",value:function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))}}]),n}(ee),ue=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t,"not-in",r)).keys=oe("not-in",r),i}return Object(y.a)(n,[{key:"matches",value:function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))}}]),n}(ee);function oe(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ot.fromName(t.referenceValue)}))}var se=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"array-contains",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return Wt(e)&&zt(e.arrayValue,this.value)}}]),n}(ee),ce=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"in",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=t.data.field(this.field);return null!==e&&zt(this.value.arrayValue,e)}}]),n}(ee),le=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"not-in",r)}return Object(y.a)(n,[{key:"matches",value:function(t){if(zt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!zt(this.value.arrayValue,e)}}]),n}(ee),fe=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){return Object(v.a)(this,n),e.call(this,t,"array-contains-any",r)}return Object(y.a)(n,[{key:"matches",value:function(t){var e=this,n=t.data.field(this.field);return!(!Wt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return zt(e.value.arrayValue,t)}))}}]),n}(ee),he=Object(y.a)((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";Object(v.a)(this,t),this.field=e,this.dir=n}));function de(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var ve=function(){function t(e){Object(v.a)(this,t),this.timestamp=e}return Object(y.a)(t,[{key:"compareTo",value:function(t){return this.timestamp._compareTo(t.timestamp)}},{key:"isEqual",value:function(t){return this.timestamp.isEqual(t.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new Pt(0,0))}},{key:"max",value:function(){return new t(new Pt(253402300799,999999999))}}]),t}(),ye=function(){function t(e,n){Object(v.a)(this,t),this.comparator=e,this.root=n||me.EMPTY}return Object(y.a)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,me.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,me.BLACK,null,null))}},{key:"get",value:function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}},{key:"indexOf",value:function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(t){return this.root.inorderTraversal(t)}},{key:"forEach",value:function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))}},{key:"toString",value:function(){var t=[];return this.inorderTraversal((function(e,n){return t.push("".concat(e,":").concat(n)),!1})),"{".concat(t.join(", "),"}")}},{key:"reverseTraversal",value:function(t){return this.root.reverseTraversal(t)}},{key:"getIterator",value:function(){return new pe(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(t){return new pe(this.root,t,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new pe(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(t){return new pe(this.root,t,this.comparator,!0)}}]),t}(),pe=function(){function t(e,n,r,i){Object(v.a)(this,t),this.isReverse=i,this.nodeStack=[];for(var a=1;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return Object(y.a)(t,[{key:"getNext",value:function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}]),t}(),me=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=a?a:t.EMPTY,this.size=this.left.size+1+this.right.size}return Object(y.a)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}},{key:"reverseTraversal",value:function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}},{key:"moveRedLeft",value:function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t}},{key:"moveRedRight",value:function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}},{key:"checkMaxDepth",value:function(){var t=this.check();return Math.pow(2,t)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw A();if(this.right.isRed())throw A();var t=this.left.check();if(t!==this.right.check())throw A();return t+(this.isRed()?0:1)}}]),t}();me.EMPTY=null,me.RED=!0,me.BLACK=!1,me.EMPTY=new(function(){function t(){Object(v.a)(this,t),this.size=0}return Object(y.a)(t,[{key:"key",get:function(){throw A()}},{key:"value",get:function(){throw A()}},{key:"color",get:function(){throw A()}},{key:"left",get:function(){throw A()}},{key:"right",get:function(){throw A()}},{key:"copy",value:function(t,e,n,r,i){return this}},{key:"insert",value:function(t,e,n){return new me(t,e)}},{key:"remove",value:function(t,e){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(t){return!1}},{key:"reverseTraversal",value:function(t){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());var ge=function(){function t(e){Object(v.a)(this,t),this.comparator=e,this.data=new ye(this.comparator)}return Object(y.a)(t,[{key:"has",value:function(t){return null!==this.data.get(t)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(t){return this.data.indexOf(t)}},{key:"forEach",value:function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"forEachInRange",value:function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}},{key:"forEachWhile",value:function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}},{key:"getIterator",value:function(){return new be(this.data.getIterator())}},{key:"getIteratorFrom",value:function(t){return new be(this.data.getIteratorFrom(t))}},{key:"add",value:function(t){return this.copy(this.data.remove(t).insert(t,!0))}},{key:"delete",value:function(t){return this.has(t)?this.copy(this.data.remove(t)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var t=[];return this.forEach((function(e){t.push(e)})),t}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),be=function(){function t(e){Object(v.a)(this,t),this.iter=e}return Object(y.a)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}(),ke=function(){function t(e){Object(v.a)(this,t),this.fields=e,e.sort(ut.comparator)}return Object(y.a)(t,[{key:"unionWith",value:function(e){var n,r=new ge(ut.comparator),i=Object(o.a)(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(l){i.e(l)}finally{i.f()}var u,s=Object(o.a)(e);try{for(s.s();!(u=s.n()).done;){var c=u.value;r=r.add(c)}}catch(l){s.e(l)}finally{s.f()}return new t(r.toArray())}},{key:"covers",value:function(t){var e,n=Object(o.a)(this.fields);try{for(n.s();!(e=n.n()).done;){if(e.value.isPrefixOf(t))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(t){return St(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}(),we=function(){function t(e){Object(v.a)(this,t),this.value=e}return Object(y.a)(t,[{key:"field",value:function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Jt(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null}},{key:"set",value:function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Xt(e)}},{key:"setAll",value:function(t){var e=this,n=ut.emptyPath(),r={},i=[];t.forEach((function(t,a){if(!n.isImmediateParentOf(a)){var u=e.getFieldsMap(n);e.applyChanges(u,r,i),r={},i=[],n=a.popLast()}t?r[a.lastSegment()]=Xt(t):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(t){var e=this.field(t.popLast());Jt(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}},{key:"isEqual",value:function(t){return Bt(this.value,t.value)}},{key:"getFieldsMap",value:function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Jt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}},{key:"applyChanges",value:function(t,e,n){It(e,(function(e,n){return t[e]=n}));var r,i=Object(o.a)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete t[a]}}catch(u){i.e(u)}finally{i.f()}}},{key:"clone",value:function(){return new t(Xt(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}(),Oe=function(){function t(e,n,r,i,a,u,o){Object(v.a)(this,t),this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=u,this.documentState=o}return Object(y.a)(t,[{key:"convertToFoundDocument",value:function(t,e){return!this.createTime.isEqual(ve.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}},{key:"convertToNoDocument",value:function(t){return this.version=t,this.documentType=2,this.data=we.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(t){return this.version=t,this.documentType=3,this.data=we.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=ve.min(),this}},{key:"setReadTime",value:function(t){return this.readTime=t,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,ve.min(),ve.min(),ve.min(),we.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r,i){return new t(e,1,n,ve.min(),r,i,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,ve.min(),ve.min(),we.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,ve.min(),ve.min(),we.empty(),2)}}]),t}(),je=Object(y.a)((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Object(v.a)(this,t),this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=u,this.endAt=o,this.S=null}));function _e(t){return new je(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}var Te=Object(y.a)((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Object(v.a)(this,t),this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=u,this.startAt=o,this.endAt=s,this.q=null,this.O=null,this.startAt,this.endAt}));function Ee(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Se(t){var e,n=Object(o.a)(t.filters);try{for(n.s();!(e=n.n()).done;){var r=e.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function Ae(t){return null!==t.collectionGroup}function Ie(t){var e=F(t);if(null===e.q){e.q=[];var n=Se(e),r=Ee(e);if(null!==n&&null===r)n.isKeyField()||e.q.push(new he(n)),e.q.push(new he(ut.keyField(),"asc"));else{var i,a=!1,u=Object(o.a)(e.explicitOrderBy);try{for(u.s();!(i=u.n()).done;){var s=i.value;e.q.push(s),s.field.isKeyField()&&(a=!0)}}catch(l){u.e(l)}finally{u.f()}if(!a){var c=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.q.push(new he(ut.keyField(),c))}}}return e.q}function Fe(t){var e=F(t);if(!e.O)if("F"===e.limitType)e.O=_e(e.path,e.collectionGroup,Ie(e),e.filters,e.limit,e.startAt,e.endAt);else{var n,r=[],i=Object(o.a)(Ie(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,u="desc"===a.dir?"asc":"desc";r.push(new he(a.field,u))}}catch(l){i.e(l)}finally{i.f()}var s=e.endAt?new $t(e.endAt.position,e.endAt.inclusive):null,c=e.startAt?new $t(e.startAt.position,e.startAt.inclusive):null;e.O=_e(e.path,e.collectionGroup,r,e.filters,e.limit,s,c)}return e.O}function Ve(t,e){e.getFirstInequalityField(),Se(t);var n=t.filters.concat([e]);return new Te(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function De(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!mt(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?function(t){return{integerValue:""+t}}(e):function(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mt(e)?"-0":e}}(t,e)}var Ne=Object(y.a)((function t(){Object(v.a)(this,t),this._=void 0})),qe=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n)}(Ne),xe=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).elements=t,r}return Object(y.a)(n)}(Ne),Pe=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).elements=t,r}return Object(y.a)(n)}(Ne),Re=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).serializer=t,i.k=r,i}return Object(y.a)(n)}(Ne),Ce=Object(y.a)((function t(e,n){Object(v.a)(this,t),this.field=e,this.transform=n})),Le=function(){function t(e,n){Object(v.a)(this,t),this.updateTime=e,this.exists=n}return Object(y.a)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}(),Me=Object(y.a)((function t(){Object(v.a)(this,t)})),Ue=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Object(v.a)(this,n),(a=e.call(this)).key=t,a.value=r,a.precondition=i,a.fieldTransforms=u,a.type=0,a}return Object(y.a)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Me),Be=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i,a){var u,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Object(v.a)(this,n),(u=e.call(this)).key=t,u.data=r,u.fieldMask=i,u.precondition=a,u.fieldTransforms=o,u.type=1,u}return Object(y.a)(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Me),ze=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).key=t,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return Object(y.a)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Me),Qe=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).key=t,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return Object(y.a)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Me),Ke={asc:"ASCENDING",desc:"DESCENDING"},Ge={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},We={and:"AND",or:"OR"},Ye=Object(y.a)((function t(e,n){Object(v.a)(this,t),this.databaseId=e,this.useProto3Json=n}));function He(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function Je(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Xe(t,e){return He(t,e.toTimestamp())}function $e(t){return I(!!t),ve.fromTimestamp(function(t){var e=Nt(t);return new Pt(e.seconds,e.nanos)}(t))}function Ze(t,e){return function(t){return new it(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function tn(t,e){return Ze(t.databaseId,e.path)}function en(t,e){var n,r=function(t){var e=it.fromString(t);return I(yn(e)),e}(e);if(r.get(1)!==t.databaseId.projectId)throw new K(N,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new K(N,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ot((I((n=r).length>4&&"documents"===n.get(4)),n.popFirst(5)))}function nn(t,e){return Ze(t.databaseId,e)}function rn(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function an(t,e,n){return{name:tn(t,e),fields:n.value.mapValue.fields}}function un(t,e){return"found"in e?function(t,e){I(!!e.found),e.found.name,e.found.updateTime;var n=en(t,e.found.name),r=$e(e.found.updateTime),i=e.found.createTime?$e(e.found.createTime):ve.min(),a=new we({mapValue:{fields:e.found.fields}});return Oe.newFoundDocument(n,r,i,a)}(t,e):"missing"in e?function(t,e){I(!!e.missing),I(!!e.readTime);var n=en(t,e.missing),r=$e(e.readTime);return Oe.newNoDocument(n,r)}(t,e):A()}function on(t,e){var n;if(e instanceof Ue)n={update:an(t,e.key,e.value)};else if(e instanceof ze)n={delete:tn(t,e.key)};else if(e instanceof Be)n={update:an(t,e.key,e.data),updateMask:vn(e.fieldMask)};else{if(!(e instanceof Qe))return A();n={verify:tn(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof qe)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xe)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Pe)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Re)return{fieldPath:e.field.canonicalString(),increment:n.k};throw A()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Xe(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:A()}(t,e.precondition)),n}function sn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=nn(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=nn(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length)return dn(ne.create(t,"and"))}(e.filters);i&&(n.structuredQuery.where=i);var a=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:hn(t.field),direction:cn(t.dir)}}(t)}))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);var u,o=function(t,e){return t.useProto3Json||pt(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function cn(t){return Ke[t]}function ln(t){return Ge[t]}function fn(t){return We[t]}function hn(t){return{fieldPath:t.canonicalString()}}function dn(t){return t instanceof ee?function(t){if("=="===t.op){if(Ht(t.value))return{unaryFilter:{field:hn(t.field),op:"IS_NAN"}};if(Yt(t.value))return{unaryFilter:{field:hn(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ht(t.value))return{unaryFilter:{field:hn(t.field),op:"IS_NOT_NAN"}};if(Yt(t.value))return{unaryFilter:{field:hn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hn(t.field),op:ln(t.op),value:t.value}}}(t):t instanceof ne?function(t){var e=t.getFilters().map((function(t){return dn(t)}));return 1===e.length?e[0]:{compositeFilter:{op:fn(t.op),filters:e}}}(t):A()}function vn(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function yn(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function pn(t){return new Ye(t,!0)}var mn=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;Object(v.a)(this,t),this.C=e,this.timerId=n,this.M=r,this.L=i,this.U=a,this.j=0,this.B=null,this.W=Date.now(),this.reset()}return Object(y.a)(t,[{key:"reset",value:function(){this.j=0}},{key:"G",value:function(){this.j=this.U}},{key:"K",value:function(t){var e=this;this.cancel();var n=Math.floor(this.j+this.Y()),r=Math.max(0,Date.now()-this.W),i=Math.max(0,n-r);i>0&&_("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.j," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.B=this.C.enqueueAfterDelay(this.timerId,i,(function(){return e.W=Date.now(),t()})),this.j*=this.L,this.j<this.M&&(this.j=this.M),this.j>this.U&&(this.j=this.U)}},{key:"H",value:function(){null!==this.B&&(this.B.skipDelay(),this.B=null)}},{key:"cancel",value:function(){null!==this.B&&(this.B.cancel(),this.B=null)}},{key:"Y",value:function(){return(Math.random()-.5)*this.j}}]),t}(),gn=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i,a){var u;return Object(v.a)(this,n),(u=e.call(this)).authCredentials=t,u.appCheckCredentials=r,u.connection=i,u.serializer=a,u.J=!1,u}return Object(y.a)(n,[{key:"X",value:function(){if(this.J)throw new K(L,"The client has already been terminated.")}},{key:"v",value:function(t,e,n){var r=this;return this.X(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=Object(u.a)(i,2),o=a[0],s=a[1];return r.connection.v(t,e,n,o,s)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===R&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),t):new K(D,t.toString())}))}},{key:"R",value:function(t,e,n,r){var i=this;return this.X(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=Object(u.a)(a,2),s=o[0],c=o[1];return i.connection.R(t,e,n,s,c,r)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===R&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),t):new K(D,t.toString())}))}},{key:"terminate",value:function(){this.J=!0}}]),n}(function(){return Object(y.a)((function t(){Object(v.a)(this,t)}))}());function bn(t,e){return kn.apply(this,arguments)}function kn(){return(kn=Object(l.a)(Object(c.a)().mark((function t(e,n){var r,i,a;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=F(e),i=rn(r.serializer)+"/documents",a={writes:n.map((function(t){return on(r.serializer,t)}))},t.next=3,r.v("Commit",i,a);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wn(t,e){return On.apply(this,arguments)}function On(){return(On=Object(l.a)(Object(c.a)().mark((function t(e,n){var r,i,a,u,o,s;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=F(e),i=rn(r.serializer)+"/documents",a={documents:n.map((function(t){return tn(r.serializer,t)}))},t.next=5,r.R("BatchGetDocuments",i,a,n.length);case 5:return u=t.sent,o=new Map,u.forEach((function(t){var e=un(r.serializer,t);o.set(e.key.toString(),e)})),s=[],t.abrupt("return",(n.forEach((function(t){var e=o.get(t.toString());I(!!e),s.push(e)})),s));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jn(){return(jn=Object(l.a)(Object(c.a)().mark((function t(e,n){var r,i;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=F(e),i=sn(r.serializer,Fe(n)),t.next=3,r.R("RunQuery",i.parent,{structuredQuery:i.structuredQuery});case 3:return t.abrupt("return",t.sent.filter((function(t){return!!t.document})).map((function(t){return function(t,e,n){var r=en(t,e.name),i=$e(e.updateTime),a=e.createTime?$e(e.createTime):ve.min(),u=new we({mapValue:{fields:e.fields}}),o=Oe.newFoundDocument(r,i,a,u);return o}(r.serializer,t.document)})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _n(){return(_n=Object(l.a)(Object(c.a)().mark((function t(e,n,r){var i,a,u,o,s,l,f,h;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=F(e),u=function(t,e,n){var r=sn(t,e),i={},a=[],u=0;return n.forEach((function(t){var e="aggregate_"+u++;i[e]=t.alias,"count"===t.$?a.push({alias:e,count:{}}):"avg"===t.$?a.push({alias:e,avg:{field:hn(t.fieldPath)}}):"sum"===t.$&&a.push({alias:e,sum:{field:hn(t.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:r.structuredQuery},parent:r.parent},Z:i}}(a.serializer,Fe(n),r),o=u.request,s=u.Z,l=o.parent,a.connection.g||delete o.parent,t.next=4,a.R("RunAggregationQuery",l,o,1);case 4:return f=t.sent.filter((function(t){return!!t.result})),I(1===f.length),h=null===(i=f[0].result)||void 0===i?void 0:i.aggregateFields,t.abrupt("return",Object.keys(h).reduce((function(t,e){return t[s[e]]=h[e],t}),{}));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Tn=new Map;function En(t){if(t._terminated)throw new K(L,"The client has already been terminated.");if(!Tn.has(t)){_("ComponentProvider","Initializing Datastore");var e=function(t){return new Ot(t,fetch.bind(null))}((i=t._databaseId,a=t.app.options.appId||"",u=t._persistenceKey,o=t._freezeSettings(),new et(i,a,u,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,vt(o.experimentalLongPollingOptions),o.useFetchStreams))),n=pn(t._databaseId),r=function(t,e,n,r){return new gn(t,e,n,r)}(t._authCredentials,t._appCheckCredentials,e,n);Tn.set(t,r)}var i,a,u,o;return Tn.get(t)}var Sn=function(){function t(e){var n,r;if(Object(v.a)(this,t),void 0===e.host){if(void 0!==e.ssl)throw new K(N,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new K(N,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}!function(t,e,n,r){if(!0===e&&!0===r)throw new K(N,"".concat("experimentalForceLongPolling"," and ").concat("experimentalAutoDetectLongPolling"," cannot be used together."))}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vt(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new K(N,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new K(N,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new K(N,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}return Object(y.a)(t,[{key:"isEqual",value:function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(e=this.experimentalLongPollingOptions,n=t.experimentalLongPollingOptions,e.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams;var e,n}}]),t}(),An=function(){function t(e,n,r,i){Object(v.a)(this,t),this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sn({}),this._settingsFrozen=!1}return Object(y.a)(t,[{key:"app",get:function(){if(!this._app)throw new K(L,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(t){if(this._settingsFrozen)throw new K(L,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sn(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Y;switch(t.type){case"firstParty":return new $(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new K(N,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(t){var e=Tn.get(t);e&&(_("ComponentProvider","Removing Datastore"),Tn.delete(t),e.terminate())}(this),Promise.resolve()}}]),t}();function In(t,e,n){n||(n="(default)");var r=Object(p.i)(t,"firestore/lite");if(r.isInitialized(n))throw new K(L,"Firestore can only be initialized once per app.");return r.initialize({options:e,instanceIdentifier:n})}function Fn(t,e){var n="object"==typeof t?t:Object(p.m)(),r="string"==typeof t?t:e||"(default)",i=Object(p.i)(n,"firestore/lite").getImmediate({identifier:r});if(!i._initialized){var a=Object(b.h)("firestore");a&&Vn.apply(void 0,[i].concat(Object(d.a)(a)))}return i}function Vn(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(t=ht(t,An))._getSettings(),u="".concat(e,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==u&&E("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:u,ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=k.MOCK_USER;else{o=Object(b.e)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new K(N,"mockUserToken must contain 'sub' or 'user_id' field!");s=new k(c)}t._authCredentials=new H(new W(o,s))}}function Dn(t){return t=ht(t,An),Object(p.k)(t.app,"firestore/lite"),t._delete()}var Nn=Object(y.a)((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",n=arguments.length>1?arguments[1]:void 0;Object(v.a)(this,t),this._aggregateType=e,this._internalFieldPath=n,this.type="AggregateField"})),qn=function(){function t(e,n,r){Object(v.a)(this,t),this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}return Object(y.a)(t,[{key:"data",value:function(){return this._userDataWriter.convertObjectMap(this._data)}}]),t}(),xn=function(){function t(e,n,r){Object(v.a)(this,t),this.converter=n,this._key=r,this.type="document",this.firestore=e}return Object(y.a)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Rn(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),Pn=function(){function t(e,n,r){Object(v.a)(this,t),this.converter=n,this._query=r,this.type="query",this.firestore=e}return Object(y.a)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),Rn=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this,t,r,new Te(i)))._path=i,a.type="collection",a}return Object(y.a)(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var t=this._path.popLast();return t.isEmpty()?null:new xn(this.firestore,null,new ot(t))}},{key:"withConverter",value:function(t){return new n(this.firestore,t,this._path)}}]),n}(Pn);function Cn(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=Object(b.i)(t),st("collection","path",e),t instanceof An){var a=it.fromString.apply(it,[e].concat(r));return lt(a),new Rn(t,null,a)}if(!(t instanceof xn||t instanceof Rn))throw new K(N,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=t._path.child(it.fromString.apply(it,[e].concat(r)));return lt(u),new Rn(t.firestore,null,u)}function Ln(t,e){if(t=ht(t,An),st("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new K(N,"Invalid collection ID '".concat(e,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new Pn(t,null,function(t){return new Te(it.emptyPath(),t)}(e))}function Mn(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=Object(b.i)(t),1===arguments.length&&(e=Tt.N()),st("doc","path",e),t instanceof An){var a=it.fromString.apply(it,[e].concat(r));return ct(a),new xn(t,null,new ot(a))}if(!(t instanceof xn||t instanceof Rn))throw new K(N,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=t._path.child(it.fromString.apply(it,[e].concat(r)));return ct(u),new xn(t.firestore,t instanceof Rn?t.converter:null,new ot(u))}function Un(t,e){return t=Object(b.i)(t),e=Object(b.i)(e),(t instanceof xn||t instanceof Rn)&&(e instanceof xn||e instanceof Rn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Bn(t,e){return t=Object(b.i)(t),e=Object(b.i)(e),t instanceof Pn&&e instanceof Pn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!de(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(!re(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zt(t.startAt,e.startAt)&&Zt(t.endAt,e.endAt)}(Fe(t),Fe(e))&&t.limitType===e.limitType}(t._query,e._query)&&t.converter===e.converter}var zn=function(){function t(e){Object(v.a)(this,t),this._byteString=e}return Object(y.a)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(t){return this._byteString.isEqual(t._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(Vt.fromBase64String(e))}catch(e){throw new K(N,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(Vt.fromUint8Array(e))}}]),t}(),Qn=function(){function t(){Object(v.a)(this,t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new K(N,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ut(n)}return Object(y.a)(t,[{key:"isEqual",value:function(t){return this._internalPath.isEqual(t._internalPath)}}]),t}();function Kn(){return new Qn("__name__")}var Gn=Object(y.a)((function t(e){Object(v.a)(this,t),this._methodName=e})),Wn=function(){function t(e,n){if(Object(v.a)(this,t),!isFinite(e)||e<-90||e>90)throw new K(N,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(N,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}return Object(y.a)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(t){return this._lat===t._lat&&this._long===t._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(t){return Et(this._lat,t._lat)||Et(this._long,t._long)}}]),t}(),Yn=/^__.*__$/,Hn=function(){function t(e,n,r){Object(v.a)(this,t),this.data=e,this.fieldMask=n,this.fieldTransforms=r}return Object(y.a)(t,[{key:"toMutation",value:function(t,e){return null!==this.fieldMask?new Be(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ue(t,this.data,e,this.fieldTransforms)}}]),t}(),Jn=function(){function t(e,n,r){Object(v.a)(this,t),this.data=e,this.fieldMask=n,this.fieldTransforms=r}return Object(y.a)(t,[{key:"toMutation",value:function(t,e){return new Be(t,this.data,this.fieldMask,e,this.fieldTransforms)}}]),t}();function Xn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}var $n=function(){function t(e,n,r,i,a,u){Object(v.a)(this,t),this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===a&&this.tt(),this.fieldTransforms=a||[],this.fieldMask=u||[]}return Object(y.a)(t,[{key:"path",get:function(){return this.settings.path}},{key:"et",get:function(){return this.settings.et}},{key:"nt",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"rt",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.nt({path:n,st:!1});return r.it(t),r}},{key:"ot",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.nt({path:n,st:!1});return r.tt(),r}},{key:"ut",value:function(t){return this.nt({path:void 0,st:!0})}},{key:"ct",value:function(t){return gr(t,this.settings.methodName,this.settings.ht||!1,this.path,this.settings.lt)}},{key:"contains",value:function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))}},{key:"tt",value:function(){if(this.path)for(var t=0;t<this.path.length;t++)this.it(this.path.get(t))}},{key:"it",value:function(t){if(0===t.length)throw this.ct("Document fields must not be empty");if(Xn(this.et)&&Yn.test(t))throw this.ct('Document fields cannot begin and end with "__"')}}]),t}(),Zn=function(){function t(e,n,r){Object(v.a)(this,t),this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||pn(e)}return Object(y.a)(t,[{key:"ft",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new $n({et:t,methodName:e,lt:n,path:ut.emptyPath(),st:!1,ht:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),t}();function tr(t){var e=t._freezeSettings(),n=pn(t._databaseId);return new Zn(t._databaseId,!!e.ignoreUndefinedProperties,n)}function er(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=t.ft(a.merge||a.mergeFields?2:0,e,n,i);vr("Data must be an object, but it was:",u,r);var s,c,l=hr(r,u);if(a.merge)s=new ke(u.fieldMask),c=u.fieldTransforms;else if(a.mergeFields){var f,h=[],d=Object(o.a)(a.mergeFields);try{for(d.s();!(f=d.n()).done;){var v=yr(e,f.value,n);if(!u.contains(v))throw new K(N,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));br(h,v)||h.push(v)}}catch(y){d.e(y)}finally{d.f()}s=new ke(h),c=u.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,c=u.fieldTransforms;return new Hn(new we(l),s,c)}var nr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"_toFieldTransform",value:function(t){if(2!==t.et)throw 1===t.et?t.ct("".concat(this._methodName,"() can only appear at the top level of your update data")):t.ct("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return t.fieldMask.push(t.path),null}},{key:"isEqual",value:function(t){return t instanceof n}}]),n}(Gn);function rr(t,e,n){return new $n({et:3,lt:e.settings.lt,methodName:t._methodName,st:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var ir=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"_toFieldTransform",value:function(t){return new Ce(t.path,new qe)}},{key:"isEqual",value:function(t){return t instanceof n}}]),n}(Gn),ar=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t)).dt=r,i}return Object(y.a)(n,[{key:"_toFieldTransform",value:function(t){var e=rr(this,t,!0),n=this.dt.map((function(t){return fr(t,e)})),r=new xe(n);return new Ce(t.path,r)}},{key:"isEqual",value:function(t){return this===t}}]),n}(Gn),ur=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t)).dt=r,i}return Object(y.a)(n,[{key:"_toFieldTransform",value:function(t){var e=rr(this,t,!0),n=this.dt.map((function(t){return fr(t,e)})),r=new Pe(n);return new Ce(t.path,r)}},{key:"isEqual",value:function(t){return this===t}}]),n}(Gn),or=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this,t)).wt=r,i}return Object(y.a)(n,[{key:"_toFieldTransform",value:function(t){var e=new Re(t.serializer,De(t.serializer,this.wt));return new Ce(t.path,e)}},{key:"isEqual",value:function(t){return this===t}}]),n}(Gn);function sr(t,e,n,r){var i=t.ft(1,e,n);vr("Data must be an object, but it was:",i,r);var a=[],u=we.empty();It(r,(function(t,r){var o=mr(e,t,n);r=Object(b.i)(r);var s=i.ot(o);if(r instanceof nr)a.push(o);else{var c=fr(r,s);null!=c&&(a.push(o),u.set(o,c))}}));var o=new ke(a);return new Jn(u,o,i.fieldTransforms)}function cr(t,e,n,r,i,a){var u=t.ft(1,e,n),o=[yr(e,r,n)],s=[i];if(a.length%2!=0)throw new K(N,"Function ".concat(e,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)o.push(yr(e,a[c])),s.push(a[c+1]);for(var l=[],f=we.empty(),h=o.length-1;h>=0;--h)if(!br(l,o[h])){var d=o[h],v=s[h];v=Object(b.i)(v);var y=u.ot(d);if(v instanceof nr)l.push(d);else{var p=fr(v,y);null!=p&&(l.push(d),f.set(d,p))}}var m=new ke(l);return new Jn(f,m,u.fieldTransforms)}function lr(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return fr(n,t.ft(r?4:3,e))}function fr(t,e){if(dr(t=Object(b.i)(t)))return vr("Unsupported field value:",e,t),hr(t,e);if(t instanceof Gn)return function(t,e){if(!Xn(e.et))throw e.ct("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.ct("".concat(t._methodName,"() is not currently supported inside arrays"));var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.st&&4!==e.et)throw e.ct("Nested arrays are not supported");return function(t,e){var n,r=[],i=0,a=Object(o.a)(t);try{for(a.s();!(n=a.n()).done;){var u=fr(n.value,e.ut(i));null==u&&(u={nullValue:"NULL_VALUE"}),r.push(u),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(t,e)}return function(t,e){if(null===(t=Object(b.i)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return De(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Pt.fromDate(t);return{timestampValue:He(e.serializer,n)}}if(t instanceof Pt){var r=new Pt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:He(e.serializer,r)}}if(t instanceof Wn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zn)return{bytesValue:Je(e.serializer,t._byteString)};if(t instanceof xn){var i=e.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw e.ct("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:Ze(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ct("Unsupported field value: ".concat(ft(t)))}(t,e)}function hr(t,e){var n={};return function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):It(t,(function(t,r){var i=fr(r,e.rt(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function dr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pt||t instanceof Wn||t instanceof zn||t instanceof xn||t instanceof Gn)}function vr(t,e,n){if(!dr(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=ft(n);throw"an object"===r?e.ct(t+" a custom object"):e.ct(t+" "+r)}}function yr(t,e,n){if((e=Object(b.i)(e))instanceof Qn)return e._internalPath;if("string"==typeof e)return mr(t,e);throw gr("Field path arguments must be of type string or ",t,!1,void 0,n)}var pr=new RegExp("[~\\*/\\[\\]]");function mr(t,e,n){if(e.search(pr)>=0)throw gr("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return Object(a.a)(Qn,Object(d.a)(e.split(".")))._internalPath}catch(r){throw gr("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function gr(t,e,n,r,i){var a=r&&!r.isEmpty(),u=void 0!==i,o="Function ".concat(e,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";var s="";return(a||u)&&(s+=" (found",a&&(s+=" in field ".concat(r)),u&&(s+=" in document ".concat(i)),s+=")"),new K(N,o+t+s)}function br(t,e){return t.some((function(t){return t.isEqual(e)}))}var kr=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Object(y.a)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new xn(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var t=new wr(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(t){if(this._document){var e=this._document.data.field(_r("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}]),t}(),wr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n,[{key:"data",value:function(){return Object(r.a)(Object(i.a)(n.prototype),"data",this).call(this)}}]),n}(kr),Or=function(){function t(e,n){Object(v.a)(this,t),this._docs=n,this.query=e}return Object(y.a)(t,[{key:"docs",get:function(){return Object(d.a)(this._docs)}},{key:"size",get:function(){return this.docs.length}},{key:"empty",get:function(){return 0===this.docs.length}},{key:"forEach",value:function(t,e){this._docs.forEach(t,e)}}]),t}();function jr(t,e){return t=Object(b.i)(t),e=Object(b.i)(e),t instanceof kr&&e instanceof kr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Or&&e instanceof Or&&Bn(t.query,e.query)&&St(t.docs,e.docs,jr)}function _r(t,e){return"string"==typeof e?mr(t,e):e instanceof Qn?e._internalPath:e._delegate._internalPath}var Tr=Object(y.a)((function t(){Object(v.a)(this,t)})),Er=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(){return Object(v.a)(this,n),e.apply(this,arguments)}return Object(y.a)(n)}(Tr);function Sr(t,e){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];e instanceof Tr&&n.push(e),function(t){var e=t.filter((function(t){return t instanceof Fr})).length,n=t.filter((function(t){return t instanceof Ar})).length;if(e>1||e>0&&n>0)throw new K(N,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var u,s=Object(o.a)(n);try{for(s.s();!(u=s.n()).done;){t=u.value._apply(t)}}catch(c){s.e(c)}finally{s.f()}return t}var Ar=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this))._field=t,a._op=r,a._value=i,a.type="where",a}return Object(y.a)(n,[{key:"_apply",value:function(t){var e=this._parse(t);return Wr(t._query,e),new Pn(t.firestore,t.converter,Ve(t._query,e))}},{key:"_parse",value:function(t){var e=tr(t.firestore),n=function(t,e,n,r,i,a,u){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new K(N,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Gr(u,a);var c,l=[],f=Object(o.a)(u);try{for(f.s();!(c=f.n()).done;){var h=c.value;l.push(Kr(r,t,h))}}catch(d){f.e(d)}finally{f.f()}s={arrayValue:{values:l}}}else s=Kr(r,t,u)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Gr(u,a),s=lr(n,"where",u,"in"===a||"not-in"===a);return ee.create(i,a,s)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(t,e,r){return new n(t,e,r)}}]),n}(Er);function Ir(t,e,n){var r=e,i=_r("where",t);return Ar._create(i,r,n)}var Fr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this)).type=t,i._queryConstraints=r,i}return Object(y.a)(n,[{key:"_parse",value:function(t){var e=this._queryConstraints.map((function(e){return e._parse(t)})).filter((function(t){return t.getFilters().length>0}));return 1===e.length?e[0]:ne.create(e,this._getOperator())}},{key:"_apply",value:function(t){var e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){var n,r=t,i=e.getFlattenedFilters(),a=Object(o.a)(i);try{for(a.s();!(n=a.n()).done;){var u=n.value;Wr(r,u),r=Ve(r,u)}}catch(s){a.e(s)}finally{a.f()}}(t._query,e),new Pn(t.firestore,t.converter,Ve(t._query,e)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(t,e){return new n(t,e)}}]),n}(Tr);function Vr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.forEach((function(t){return Hr("or",t)})),Fr._create("or",e)}function Dr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.forEach((function(t){return Hr("and",t)})),Fr._create("and",e)}var Nr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r){var i;return Object(v.a)(this,n),(i=e.call(this))._field=t,i._direction=r,i.type="orderBy",i}return Object(y.a)(n,[{key:"_apply",value:function(t){var e=function(t,e,n){if(null!==t.startAt)throw new K(N,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new K(N,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new he(e,n);return function(t,e){if(null===Ee(t)){var n=Se(t);null!==n&&Yr(t,n,e.field)}}(t,r),r}(t._query,this._field,this._direction);return new Pn(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Te(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}],[{key:"_create",value:function(t,e){return new n(t,e)}}]),n}(Er);function qr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=_r("orderBy",t);return Nr._create(n,e)}var xr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).type=t,a._limit=r,a._limitType=i,a}return Object(y.a)(n,[{key:"_apply",value:function(t){return new Pn(t.firestore,t.converter,function(t,e,n){return new Te(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t._query,this._limit,this._limitType))}}],[{key:"_create",value:function(t,e,r){return new n(t,e,r)}}]),n}(Er);function Pr(t){return dt("limit",t),xr._create("limit",t,"F")}function Rr(t){return dt("limitToLast",t),xr._create("limitToLast",t,"L")}var Cr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).type=t,a._docOrFields=r,a._inclusive=i,a}return Object(y.a)(n,[{key:"_apply",value:function(t){var e=Qr(t,this.type,this._docOrFields,this._inclusive);return new Pn(t.firestore,t.converter,function(t,e){return new Te(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))}}],[{key:"_create",value:function(t,e,r){return new n(t,e,r)}}]),n}(Er);function Lr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Cr._create("startAt",e,!0)}function Mr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Cr._create("startAfter",e,!1)}var Ur=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t,r,i){var a;return Object(v.a)(this,n),(a=e.call(this)).type=t,a._docOrFields=r,a._inclusive=i,a}return Object(y.a)(n,[{key:"_apply",value:function(t){var e=Qr(t,this.type,this._docOrFields,this._inclusive);return new Pn(t.firestore,t.converter,function(t,e){return new Te(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))}}],[{key:"_create",value:function(t,e,r){return new n(t,e,r)}}]),n}(Er);function Br(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ur._create("endBefore",e,!1)}function zr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ur._create("endAt",e,!0)}function Qr(t,e,n,r){if(n[0]=Object(b.i)(n[0]),n[0]instanceof kr)return function(t,e,n,r,i){if(!r)throw new K(x,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,u=[],s=Object(o.a)(Ie(t));try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.field.isKeyField())u.push(Gt(e,r.key));else{var l=r.data.field(c.field);if(Rt(l))throw new K(N,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===l){var f=c.field.canonicalString();throw new K(N,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(f,"' (used as the orderBy) does not exist."))}u.push(l)}}}catch(h){s.e(h)}finally{s.f()}return new $t(u,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=tr(t.firestore);return function(t,e,n,r,i,a){var u=t.explicitOrderBy;if(i.length>u.length)throw new K(N,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var o=[],s=0;s<i.length;s++){var c=i[s];if(u[s].field.isKeyField()){if("string"!=typeof c)throw new K(N,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!Ae(t)&&-1!==c.indexOf("/"))throw new K(N,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=t.path.child(it.fromString(c));if(!ot.isDocumentKey(l))throw new K(N,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new ot(l);o.push(Gt(e,f))}else{var h=lr(n,r,c);o.push(h)}}return new $t(o,a)}(t._query,t.firestore._databaseId,i,e,n,r)}function Kr(t,e,n){if("string"==typeof(n=Object(b.i)(n))){if(""===n)throw new K(N,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ae(e)&&-1!==n.indexOf("/"))throw new K(N,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=e.path.child(it.fromString(n));if(!ot.isDocumentKey(r))throw new K(N,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Gt(t,new ot(r))}if(n instanceof xn)return Gt(t,n._key);throw new K(N,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(ft(n),"."))}function Gr(t,e){if(!Array.isArray(t)||0===t.length)throw new K(N,"Invalid Query. A non-empty array is required for '".concat(e.toString(),"' filters."))}function Wr(t,e){if(e.isInequality()){var n=Se(t),r=e.field;if(null!==n&&!n.isEqual(r))throw new K(N,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=Ee(t);null!==i&&Yr(t,r,i)}var a=function(t,e){var n,r=Object(o.a)(t);try{for(r.s();!(n=r.n()).done;){var i,a=n.value,u=Object(o.a)(a.getFlattenedFilters());try{for(u.s();!(i=u.n()).done;){var s=i.value;if(e.indexOf(s.op)>=0)return s.op}}catch(c){u.e(c)}finally{u.f()}}}catch(c){r.e(c)}finally{r.f()}return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==a)throw a===e.op?new K(N,"Invalid query. You cannot use more than one '".concat(e.op.toString(),"' filter.")):new K(N,"Invalid query. You cannot use '".concat(e.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function Yr(t,e,n){if(!n.isEqual(e))throw new K(N,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(e.toString(),"' and so you must also use '").concat(e.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function Hr(t,e){if(!(e instanceof Ar||e instanceof Fr))throw new K(N,"Function ".concat(t,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}function Jr(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Xr=function(t){Object(f.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(v.a)(this,n),(r=e.call(this)).firestore=t,r}return Object(y.a)(n,[{key:"convertBytes",value:function(t){return new zn(t)}},{key:"convertReference",value:function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new xn(this.firestore,null,e)}}]),n}(function(){function t(){Object(v.a)(this,t)}return Object(y.a)(t,[{key:"convertValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ut(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(xt(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw A()}}},{key:"convertObject",value:function(t,e){return this.convertObjectMap(t.fields,e)}},{key:"convertObjectMap",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return It(t,(function(t,i){r[t]=e.convertValue(i,n)})),r}},{key:"convertGeoPoint",value:function(t){return new Wn(qt(t.latitude),qt(t.longitude))}},{key:"convertArray",value:function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))}},{key:"convertServerTimestamp",value:function(t,e){switch(e){case"previous":var n=Ct(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Lt(t));default:return null}}},{key:"convertTimestamp",value:function(t){var e=Nt(t);return new Pt(e.seconds,e.nanos)}},{key:"convertDocumentKey",value:function(t,e){var n=it.fromString(t);I(yn(n));var r=new nt(n.get(1),n.get(3)),i=new ot(n.popFirst(5));return r.isEqual(e)||T("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}]),t}());function $r(t){var e=En((t=ht(t,xn)).firestore),n=new Xr(t.firestore);return wn(e,[t._key]).then((function(e){I(1===e.length);var r=e[0];return new kr(t.firestore,n,t._key,r.isFoundDocument()?r:null,t.converter)}))}function Zr(t){!function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new K(B,"limitToLast() queries require specifying at least one orderBy() clause")}((t=ht(t,Pn))._query);var e=En(t.firestore),n=new Xr(t.firestore);return function(t,e){return jn.apply(this,arguments)}(e,t._query).then((function(e){var r=e.map((function(e){return new wr(t.firestore,n,e.key,e,t.converter)}));return"L"===t._query.limitType&&r.reverse(),new Or(t,r)}))}function ti(t,e,n){var r=Jr((t=ht(t,xn)).converter,e,n),i=er(tr(t.firestore),"setDoc",t._key,r,null!==t.converter,n);return bn(En(t.firestore),[i.toMutation(t._key,Le.none())])}function ei(t,e,n){for(var r,i=tr((t=ht(t,xn)).firestore),a=arguments.length,u=new Array(a>3?a-3:0),o=3;o<a;o++)u[o-3]=arguments[o];return r="string"==typeof(e=Object(b.i)(e))||e instanceof Qn?cr(i,"updateDoc",t._key,e,n,u):sr(i,"updateDoc",t._key,e),bn(En(t.firestore),[r.toMutation(t._key,Le.exists(!0))])}function ni(t){return bn(En((t=ht(t,xn)).firestore),[new ze(t._key,Le.none())])}function ri(t,e){var n=Mn(t=ht(t,Rn)),r=Jr(t.converter,e),i=er(tr(t.firestore),"addDoc",n._key,r,null!==n.converter,{});return bn(En(t.firestore),[i.toMutation(n._key,Le.exists(!1))]).then((function(){return n}))}function ii(t){return ai(t,{count:si()})}function ai(t,e){var n=ht(t.firestore,An),r=En(n),i=function(t,e){var n=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r));return n}(e,(function(t,e){return new jt(e,t._aggregateType,t._internalFieldPath)}));return function(t,e,n){return _n.apply(this,arguments)}(r,t._query,i).then((function(e){return function(t,e,n){var r=new Xr(t);return new qn(e,r,n)}(n,t,e)}))}function ui(t){return new Nn("sum",yr("sum",t))}function oi(t){return new Nn("avg",yr("average",t))}function si(){return new Nn("count")}function ci(t,e){var n,r;return t instanceof Nn&&e instanceof Nn&&t._aggregateType===e._aggregateType&&(null===(n=t._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=e._internalFieldPath)||void 0===r?void 0:r.canonicalString())}function li(t,e){return Bn(t.query,e.query)&&Object(b.f)(t.data(),e.data())}function fi(){return new nr("deleteField")}function hi(){return new ir("serverTimestamp")}function di(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new ar("arrayUnion",e)}function vi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new ur("arrayRemove",e)}function yi(t){return new or("increment",t)}var pi=function(){function t(e,n){Object(v.a)(this,t),this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=tr(e)}return Object(y.a)(t,[{key:"set",value:function(t,e,n){this._verifyNotCommitted();var r=mi(t,this._firestore),i=Jr(r.converter,e,n),a=er(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Le.none())),this}},{key:"update",value:function(t,e,n){this._verifyNotCommitted();for(var r,i=mi(t,this._firestore),a=arguments.length,u=new Array(a>3?a-3:0),o=3;o<a;o++)u[o-3]=arguments[o];return r="string"==typeof(e=Object(b.i)(e))||e instanceof Qn?cr(this._dataReader,"WriteBatch.update",i._key,e,n,u):sr(this._dataReader,"WriteBatch.update",i._key,e),this._mutations.push(r.toMutation(i._key,Le.exists(!0))),this}},{key:"delete",value:function(t){this._verifyNotCommitted();var e=mi(t,this._firestore);return this._mutations=this._mutations.concat(new ze(e._key,Le.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new K(L,"A write batch can no longer be used after commit() has been called.")}}]),t}();function mi(t,e){if((t=Object(b.i)(t)).firestore!==e)throw new K(N,"Provided document reference is from a different Firestore instance.");return t}function gi(t){var e=En(t=ht(t,An));return new pi(t,(function(t){return bn(e,t)}))}var bi=function(){function t(e){Object(v.a)(this,t),this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return Object(y.a)(t,[{key:"lookup",value:function(){var t=Object(l.a)(Object(c.a)().mark((function t(e){var n,r=this;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){t.next=2;break}throw new K(N,"Firestore transactions require all reads to be executed before all writes.");case 2:return t.next=4,wn(this.datastore,e);case 4:return n=t.sent,t.abrupt("return",(n.forEach((function(t){return r.recordVersion(t)})),n));case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"set",value:function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}},{key:"update",value:function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())}},{key:"delete",value:function(t){this.write(new ze(t,this.precondition(t))),this.writtenDocs.add(t.toString())}},{key:"commit",value:function(){var t=Object(l.a)(Object(c.a)().mark((function t(){var e,n=this;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){t.next=2;break}throw this.lastWriteError;case 2:return e=this.readVersions,this.mutations.forEach((function(t){e.delete(t.key.toString())})),e.forEach((function(t,e){var r=ot.fromPath(e);n.mutations.push(new Qe(r,n.precondition(r)))})),t.next=7,bn(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"recordVersion",value:function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw A();e=ve.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new K(M,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}},{key:"precondition",value:function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(ve.min())?Le.exists(!1):Le.updateTime(e):Le.none()}},{key:"preconditionForUpdate",value:function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ve.min()))throw new K(N,"Can't update a document that doesn't exist.");return Le.updateTime(e)}return Le.exists(!0)}},{key:"write",value:function(t){this.ensureCommitNotCalled(),this.mutations.push(t)}},{key:"ensureCommitNotCalled",value:function(){}}]),t}(),ki={maxAttempts:5},wi=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.yt=r.maxAttempts,this.gt=new mn(this.asyncQueue,"transaction_retry")}return Object(y.a)(t,[{key:"run",value:function(){this.yt-=1,this._t()}},{key:"_t",value:function(){var t=this;this.gt.K(Object(l.a)(Object(c.a)().mark((function e(){var n,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new bi(t.datastore),(r=t.vt(n))&&r.then((function(e){t.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){t.deferred.resolve(e)})).catch((function(e){t.bt(e)}))}))})).catch((function(e){t.bt(e)}));case 2:case"end":return e.stop()}}),e)}))))}},{key:"vt",value:function(t){try{var e=this.updateFunction(t);return!pt(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}},{key:"bt",value:function(t){var e=this;this.yt>0&&this.Et(t)?(this.yt-=1,this.asyncQueue.enqueueAndForget((function(){return e._t(),Promise.resolve()}))):this.deferred.reject(t)}},{key:"Et",value:function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!function(t){switch(t){default:return A();case V:case D:case q:case C:case z:case Q:case R:return!1;case N:case x:case"already-exists":case P:case L:case M:case U:case B:case"data-loss":return!0}}(e)}return!1}}]),t}();function Oi(){return"undefined"!=typeof document?document:null}var ji,_i=function(){function t(e,n,r,i,a){Object(v.a)(this,t),this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new G,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return Object(y.a)(t,[{key:"start",value:function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new K(V,"Operation cancelled"+(t?": "+t:""))))}},{key:"handleDelayElapsed",value:function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var u=new t(e,n,Date.now()+r,i,a);return u.start(r),u}}]),t}(),Ti=function(){function t(){var e=this;Object(v.a)(this,t),this.It=Promise.resolve(),this.Tt=[],this.At=!1,this.Rt=[],this.Pt=null,this.Vt=!1,this.$t=!1,this.Nt=[],this.gt=new mn(this,"async_queue_retry"),this.Dt=function(){var t=Oi();t&&_("AsyncQueue","Visibility state changed to "+t.visibilityState),e.gt.H()};var n=Oi();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Dt)}return Object(y.a)(t,[{key:"isShuttingDown",get:function(){return this.At}},{key:"enqueueAndForget",value:function(t){this.enqueue(t)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(t){this.Ft(),this.xt(t)}},{key:"enterRestrictedMode",value:function(t){if(!this.At){this.At=!0,this.$t=t||!1;var e=Oi();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Dt)}}},{key:"enqueue",value:function(t){var e=this;if(this.Ft(),this.At)return new Promise((function(){}));var n=new G;return this.xt((function(){return e.At&&e.$t?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(t){var e=this;this.enqueueAndForget((function(){return e.Tt.push(t),e.St()}))}},{key:"St",value:function(){var t=Object(l.a)(Object(c.a)().mark((function t(){var e=this;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this.Tt.length){t.next=14;break}return t.prev=1,t.next=4,this.Tt[0]();case 4:this.Tt.shift(),this.gt.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),"IndexedDbTransactionError"===t.t0.name){t.next=12;break}throw t.t0;case 12:_("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:this.Tt.length>0&&this.gt.K((function(){return e.St()}));case 14:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(){return t.apply(this,arguments)}}()},{key:"xt",value:function(t){var e=this,n=this.It.then((function(){return e.Vt=!0,t().catch((function(t){e.Pt=t,e.Vt=!1;var n=function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw T("INTERNAL UNHANDLED ERROR: ",n),t})).then((function(t){return e.Vt=!1,t}))}));return this.It=n,n}},{key:"enqueueAfterDelay",value:function(t,e,n){var r=this;this.Ft(),this.Nt.indexOf(t)>-1&&(e=0);var i=_i.createAndSchedule(this,t,e,n,(function(t){return r.qt(t)}));return this.Rt.push(i),i}},{key:"Ft",value:function(){this.Pt&&A()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Ot",value:function(){var t=Object(l.a)(Object(c.a)().mark((function t(){var e;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.It,t.next=3,e;case 3:if(e!==this.It){t.next=0;break}case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"kt",value:function(t){var e,n=Object(o.a)(this.Rt);try{for(n.s();!(e=n.n()).done;){if(e.value.timerId===t)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Ct",value:function(t){var e=this;return this.Ot().then((function(){e.Rt.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));var n,r=Object(o.a)(e.Rt);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==t&&i.timerId===t)break}}catch(a){r.e(a)}finally{r.f()}return e.Ot()}))}},{key:"Mt",value:function(t){this.Nt.push(t)}},{key:"qt",value:function(t){var e=this.Rt.indexOf(t);this.Rt.splice(e,1)}}]),t}(),Ei=function(){function t(e,n){Object(v.a)(this,t),this._firestore=e,this._transaction=n,this._dataReader=tr(e)}return Object(y.a)(t,[{key:"get",value:function(t){var e=this,n=mi(t,this._firestore),r=new Xr(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return A();var i=t[0];if(i.isFoundDocument())return new kr(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new kr(e._firestore,r,n._key,null,n.converter);throw A()}))}},{key:"set",value:function(t,e,n){var r=mi(t,this._firestore),i=Jr(r.converter,e,n),a=er(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(t,e,n){for(var r,i=mi(t,this._firestore),a=arguments.length,u=new Array(a>3?a-3:0),o=3;o<a;o++)u[o-3]=arguments[o];return r="string"==typeof(e=Object(b.i)(e))||e instanceof Qn?cr(this._dataReader,"Transaction.update",i._key,e,n,u):sr(this._dataReader,"Transaction.update",i._key,e),this._transaction.update(i._key,r),this}},{key:"delete",value:function(t){var e=mi(t,this._firestore);return this._transaction.delete(e._key),this}}]),t}();function Si(t,e,n){var r=En(t=ht(t,An)),i=Object.assign(Object.assign({},ki),n);!function(t){if(t.maxAttempts<1)throw new K(N,"Max attempts must be at least 1")}(i);var a=new G;return new wi(new Ti,r,i,(function(n){return e(new Ei(t,n))}),a).run(),a.promise}ji="".concat(p.b,"_lite"),w=ji,Object(p.j)(new m.a("firestore/lite",(function(t,e){var n=e.instanceIdentifier,r=e.options,i=t.getProvider("app").getImmediate(),a=new An(new J(t.getProvider("auth-internal")),new tt(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new K(N,'"projectId" not provided in firebase.initializeApp.');return new nt(t.options.projectId,e)}(i,n),i);return r&&a._setSettings(r),a}),"PUBLIC").setMultipleInstances(!0)),Object(p.q)("firestore-lite","3.13.0",""),Object(p.q)("firestore-lite","3.13.0","esm2017")}}]);
//# sourceMappingURL=259.ac929a45.chunk.js.map