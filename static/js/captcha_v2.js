(() => { "use strict"; var t = function () { function t() { } return t.serverUrl = "", t.videoManualUrl = "https://partner-25.wistia.com/medias/3my58mgg7b", t.challengeWidth = 372, t.canvasWidth = 318, t.canvasHeight = 252, t.puzzleSize = 64, t.clickCircleRadius = 20, t.sliderStartPosition = 8, t.totalIconsAmount = 3, t.lightColor = "#F5F9FF", t.darkColor = "#16191D", t.semiDarkColor = "#21252C", t.blueColor = "#0080FF", t.primaryBorderColor = "rgba(240, 242, 244, 0.1)", t.secondaryBorderColor = "rgba(0, 26, 51, 0.1)", t.loadingText = "Loading...", t.successText = "Great job!", t.failedText = "Please try again!", t.barText = "Slide to complete the puzzle", t.errorText = "Session expired. Please try again!", t.errorKeyText = "Invalid site key", t.humanText = "I'm not a robot", t.iconsOrderText = "Select in this order:", t.shortTimeout = 500, t.mediumTimeout = 750, t.standartTimeout = 1e3, t.oneMinuteTimeout = 6e4, t.threeMinutsTimeout = 18e4, t.checkSite = "check-site.php", t.createChallenge = "create-challenge.php", t.slideChallenge = "slide-challenge", t.slideVerify = "slide-verify.php", t.iconsChallenge = "icons-challenge.php", t.iconsVerify = "icons-verify.php", t }(), e = function () { function t() { } return t.setStyles = function (t, e) { for (var i in void 0 === e && (e = {}), e) { var n = e[i], o = i.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase(); t.style.setProperty(o, n) } }, t.flexManipulation = function (t, e) { void 0 === e && (e = "center"), this.setStyles(t, { display: "flex", justifyContent: e, alignItems: "center" }) }, t.createDelayAnimation = function (t, e) { var i = null, n = function (o) { i || (i = o), o - i < t ? requestAnimationFrame(n) : e() }; requestAnimationFrame(n) }, t }(), i = function () { return i = Object.assign || function (t) { for (var e, i = 1, n = arguments.length; i < n; i++)for (var o in e = arguments[i]) Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]); return t }, i.apply(this, arguments) }, n = function () { function n() { this.spriteIconStartPosition = -2, this.orderIconSize = 22, this.spinnerSize = 28, this.commonSizeSmall = 24, this.commonSizeNormal = 40, this.microTimeout = 250, this.spacingSmall = 8, this.verifyButtonHoverColor = "#2791FA" } return n.prototype.createElement = function (t, i) { void 0 === i && (i = {}); var n = document.createElement(t); return Object.keys(i).length > 0 && e.setStyles(n, i), n }, n.prototype.createCanvas = function (e) { void 0 === e && (e = {}); var i = this.createElement("canvas", e); return i.setAttribute("width", "".concat(t.canvasWidth - 2)), i.setAttribute("height", "".concat(t.canvasHeight - 2)), i }, n.prototype.createIcon = function (e) { var n = this, o = e.position, r = void 0 === o ? "" : o, a = e.width, s = e.height, l = e.hoverPosition, c = void 0 === l ? "" : l, h = e.styles, u = void 0 === h ? {} : h, d = { width: a, height: s, background: "url('".concat(t.serverUrl, "/static/challenges/sprites/icons_sprite.png') no-repeat"), backgroundPosition: "".concat(this.spriteIconStartPosition, "px ").concat(r) }, p = this.createElement("div", i(i({}, d), u)); return c && (p.addEventListener("mouseover", (function () { p.style.backgroundPosition = "".concat(n.spriteIconStartPosition, "px ").concat(c) })), p.addEventListener("mouseleave", (function () { p.style.backgroundPosition = "".concat(n.spriteIconStartPosition, "px ").concat(r) }))), p }, n.prototype.createLink = function () { return this.createElement("link") }, n.prototype.createOrderIcon = function (t) { return void 0 === t && (t = ""), this.createIcon({ position: t, width: "".concat(this.orderIconSize, "px"), height: "".concat(this.orderIconSize, "px") }) }, n.prototype.createControlIcon = function (t, e) { return void 0 === t && (t = ""), void 0 === e && (e = ""), this.createIcon({ position: t, hoverPosition: e, width: "".concat(this.commonSizeSmall, "px"), height: "".concat(this.commonSizeSmall, "px"), styles: { marginRight: "9px", cursor: "pointer" } }) }, n.prototype.createCaptcha = function (e) { return this.createElement("div", { position: "relative", minWidth: "250px", maxWidth: "".concat(t.challengeWidth, "px"), height: "88px", backgroundColor: e ? t.darkColor : "white", borderRadius: "13px", display: "flex", alignItems: "center", padding: "".concat(this.commonSizeSmall, "px"), boxSizing: "border-box", boxShadow: "0 0 4px 1px rgba(0,0,0,.08)" }) }, n.prototype.createCheckbox = function (i) { var n = this.createElement("div", { width: "".concat(this.commonSizeNormal, "px"), height: "".concat(this.commonSizeNormal, "px"), backgroundColor: i ? t.semiDarkColor : t.lightColor, border: "2px solid ".concat(i ? t.primaryBorderColor : t.secondaryBorderColor), borderRadius: "10px", marginRight: "12px", transition: "border-color 0.25s", boxSizing: "border-box" }); return e.flexManipulation(n), n }, n.prototype.createChecked = function () { return this.createElement("div", { width: "".concat(this.commonSizeSmall, "px"), height: "".concat(this.commonSizeSmall, "px"), borderRadius: "5px", backgroundColor: t.blueColor }) }, n.prototype.createHumanText = function (e) { var i = this.createElement("span", { fontSize: "18.5px", fontWeight: 500, color: e ? t.lightColor : "black", fontFamily: "Plus Jakarta Sans, sans-serif" }); return i.textContent = t.humanText, i }, n.prototype.createHumanBlock = function () { return this.createElement("div", { display: "flex", alignItems: "center", cursor: "pointer" }) }, n.prototype.createErrorMessage = function () { var e = this.createElement("span", { position: "absolute", top: "4px", color: "red", fontSize: "13px", display: "none", fontFamily: "Plus Jakarta Sans, sans-serif" }); return e.textContent = t.errorText, e }, n.prototype.createCaptchaValue = function () { var t = this.createElement("input"); return t.setAttribute("type", "hidden"), t.setAttribute("name", "captcha-response"), t.setAttribute("value", ""), t }, n.prototype.createPopup = function () { var t = this.createElement("div", { position: "fixed", top: 0, left: 0, width: "100vw", height: "100vh", backgroundColor: "rgba(0, 0, 0, 0.3)", zIndex: 99, transition: "opacity 0.3s ease-in-out, visibility 0.3s ease-in-out" }); return t.open = function () { e.setStyles(t, { opacity: "1", visibility: "visible", pointerEvents: "initial" }) }, t.close = function () { e.setStyles(t, { opacity: "0", visibility: "hidden", pointerEvents: "none" }) }, t }, n.prototype.createPopupContent = function (e) { return this.createElement("div", { width: "".concat(t.challengeWidth, "px"), height: "432px", position: "absolute", top: "50%", left: "50%", transform: "translate(-50%, -50%)", backgroundColor: e ? t.darkColor : "white", padding: "".concat(this.commonSizeSmall, "px 27px"), borderRadius: "22px", boxSizing: "border-box", overflow: "hidden", fontFamily: "Plus Jakarta Sans, sans-serif", userSelect: "none" }) }, n.prototype.createCanvasWrapper = function () { return this.createElement("div", { position: "relative", width: "".concat(t.canvasWidth, "px"), height: "".concat(t.canvasHeight, "px"), borderRadius: "12px", overflow: "hidden", backgroundColor: "transparent" }) }, n.prototype.createChallengePuzzle = function () { return this.createCanvas({ position: "absolute", left: "".concat(this.spacingSmall, "px"), top: "0" }) }, n.prototype.createResult = function () { var i = this, n = this.createElement("div", { position: "absolute", left: 0, bottom: "-".concat(this.commonSizeNormal, "px"), width: "100%", height: "".concat(this.commonSizeNormal, "px"), color: "white", fontSize: "16px", fontWeight: 600, transition: "bottom 0.3s ease-in-out" }); return e.flexManipulation(n), n.success = function () { e.setStyles(n, { backgroundColor: "#20DF70", bottom: "0" }), n.textContent = t.successText }, n.error = function () { e.setStyles(n, { backgroundColor: "#F53D3D", bottom: "0" }), n.textContent = t.failedText }, n.hide = function () { e.setStyles(n, { bottom: "-".concat(i.commonSizeNormal, "px") }) }, n }, n.prototype.createSlideContainer = function (i) { var n = this.createElement("div", { textAlign: "center", lineHeight: "".concat(this.commonSizeNormal, "px"), color: "#45494C", borderRadius: "10px", boxSizing: "border-box", margin: "".concat(this.commonSizeSmall, "px 0 0 0"), padding: "".concat(this.spacingSmall, "px"), height: "60px", backgroundColor: i ? t.semiDarkColor : "#F0F2F4", border: i ? "1px solid ".concat(t.primaryBorderColor) : "none" }); return e.flexManipulation(n, "end"), n }, n.prototype.createSlider = function () { var t = this.createElement("div", { position: "absolute", left: "".concat(this.spacingSmall, "px"), backgroundColor: "#009EFB", boxSizing: "border-box", width: "72px", height: "44px", boxShabow: "0 0 3px rgba(0, 0, 0, 0.3)", cursor: "pointer", transition: "background 0.2s cubic-bezier(0.4, 2.5, 0.4, 0.6)", borderRadius: "10px" }); return e.flexManipulation(t), t }, n.prototype.createSliderIcon = function () { return this.createIcon({ position: "-2px", width: "17px", height: "15px", styles: { pointerEvents: "none", userSelect: "none" } }) }, n.prototype.createSliderText = function () { return this.createElement("span", { color: t.blueColor, fontSize: "16px", fontWeight: 600 }) }, n.prototype.createControlPanel = function () { var t = this.createElement("div"); return e.setStyles(t, { display: "flex" }), t }, n.prototype.createChallenge = function (i) { var n = this, o = this.createElement("div", { position: "relative", left: "".concat(t.challengeWidth, "px"), transform: "scale(0.9)", transition: "left 0.3s, transform 0.25s", overflow: "hidden", marginBottom: "".concat(this.commonSizeSmall, "px") }); return o.show = function () { e.setStyles(o, { opacity: "1", left: "0" }), e.createDelayAnimation(300, (function () { e.setStyles(o, { transform: "scale(1)" }), i() })) }, o.hide = function () { e.setStyles(o, { transform: "scale(0.9)" }), setTimeout((function () { e.setStyles(o, { left: "-".concat(t.challengeWidth, "px") }), document.hidden ? e.setStyles(o, { opacity: "0", left: "".concat(t.challengeWidth, "px") }) : setTimeout((function () { e.setStyles(o, { opacity: "0", left: "".concat(t.challengeWidth, "px") }) }), n.microTimeout) }), n.microTimeout) }, o }, n.prototype.createFooter = function () { var t = this.createElement("div"); return e.flexManipulation(t, "space-between"), t }, n.prototype.createSpinner = function (i) { var n = this.createElement("div", { width: "".concat(this.spinnerSize, "px"), height: "".concat(this.spinnerSize, "px"), border: "5px solid ".concat(t.blueColor), borderRadius: "50%", borderTopColor: "rgba(0, 128, 255, 0.3)", boxSizing: "border-box" }); return n.animationId = null, n.start = function () { var t = 0, o = performance.now(), r = function (i) { t = (i - o) / 2 % 360, e.setStyles(n, { transform: "rotate(".concat(t, "deg)") }), n.animationId = requestAnimationFrame(r) }; r(performance.now()), i.append(this) }, n.stop = function () { n.animationId && (cancelAnimationFrame(n.animationId), i.innerHTML = "") }, n }, n.prototype.createVerifyButton = function () { var i = this, n = this.createElement("button", { width: "".concat(t.canvasWidth, "px"), height: "56px", backgroundColor: t.blueColor, color: "white", fontSize: "19px", letterSpacing: "1px", border: "1px solid ".concat(t.blueColor), borderRadius: "10px", margin: "".concat(this.commonSizeSmall, "px 0 0 0"), cursor: "pointer", transition: "backgroundColor 0.3s border 0.3s" }); return e.flexManipulation(n), n.textContent = "Apply", n.setAttribute("type", "button"), n.addEventListener("mouseover", (function () { e.setStyles(n, { backgroundColor: i.verifyButtonHoverColor, borderColor: i.verifyButtonHoverColor }) })), n.addEventListener("mouseleave", (function () { e.setStyles(n, { backgroundColor: t.blueColor, borderColor: t.blueColor }) })), n }, n.prototype.createOrder = function (i) { var n = this.createElement("div", { marginBottom: "".concat(this.commonSizeSmall, "px") }); e.flexManipulation(n, "space-between"); var o = i ? t.lightColor : "#001A33", r = this.createElement("span", { color: o, fontSize: "18px", fontWeight: 600, lineHeight: 1 }); r.textContent = t.iconsOrderText; var a = this.createElement("div", { display: "flex" }), s = { buy: { dark: "-91px", light: "-67px" }, calendar: { dark: "-141px", light: "-115px" }, star: { dark: "-21px", light: "-44px" } }, l = function (t) { return i ? s[t].dark : s[t].light }, c = { buy: this.createOrderIcon(l("buy")), calendar: this.createOrderIcon(l("calendar")), star: this.createOrderIcon(l("star")) }; return n.showIcons = function (t, i) { void 0 === i && (i = !1), i && Object.entries(s).forEach((function (t) { var i = t[0]; e.setStyles(c[i], { backgroundPosition: "-2px ".concat(l(i)) }) })); var n = t.map((function (t) { var e; return null !== (e = c[t]) && void 0 !== e ? e : "" })), o = a.children; o.length > 0 && e.setStyles(o[1], { margin: "0" }), a.append.apply(a, n), o[1] && e.setStyles(o[1], { margin: "0 7px" }) }, n.append(r, a), n }, n }(), o = function () { return o = Object.assign || function (t) { for (var e, i = 1, n = arguments.length; i < n; i++)for (var o in e = arguments[i]) Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]); return t }, o.apply(this, arguments) }, r = function () { function i(t, e) { void 0 === t && (t = null), void 0 === e && (e = function () { }), this.element = t, this.errorMessage = null, this.captcha = null, this.checkbox = null, this.checked = null, this.humanBlock = null, this.humanText = null, this.spinner = null, this.captchaValue = null, this.popup = null, this.popupContent = null, this.challenge = null, this.canvasWrapper = null, this.canvas = null, this.canvasCtx = null, this.challengePuzzle = null, this.challengePuzzleCtx = null, this.sliderContainer = null, this.slider = null, this.sliderText = null, this.result = null, this.refreshIcon = null, this.closeIcon = null, this.infoIcon = null, this.order = null, this.verifyButton = null, this.lastCallTimestamp = 0, this.startX = 0, this.startY = 0, this.trailX = [], this.trailY = [], this.verified = !1, this.isMouseDown = !1, this.isPopupCanBeClosed = !0, this.isSliderCaptcha = !0, this.isDark = !1, this.challengeData = null, this.captcha_id = null, this.clickedIcons = [], this.oneMinTimoutId = null, this.threeMinsTimoutId = null, this.initRequestBody = {}, this.dispatch = e, this.elementsCreator = new n, this.boundHandleHumanClick = this.handleHumanBlockClick.bind(this), this.boundHandleDragStart = this.handleDragStart.bind(this), this.boundHandleDragMove = this.handleDragMove.bind(this), this.boundHandleDragEnd = this.handleDragEnd.bind(this), this.boundVerifyButtonClick = this.handleVerifyButtonClick.bind(this), this.boundHandleCanvasClick = this.handleCanvasClick.bind(this), this.boundTrackingPopupContentEvents = this.trackingPopupContentEvents.bind(this), this.init() } return i.prototype.init = function () { var i, n, o = this; try { this.isDark = "dark" === (null === (i = this.element) || void 0 === i ? void 0 : i.getAttribute("data-theme")), this.initRequestBody = { site_key: null === (n = this.element) || void 0 === n ? void 0 : n.getAttribute("data-sitekey"), site_domain: window.location.origin }, this.initCaptcha(), this.fetchData(t.checkSite, this.initRequestBody, (function () { var i, n; (null === (i = o.challengeData) || void 0 === i ? void 0 : i.success) ? (o.observeDataThemeAttribute(), o.bindInitialsEvents()) : o.errorMessage && ("Error" === (null === (n = o.challengeData) || void 0 === n ? void 0 : n.message) ? o.errorMessage.textContent = "Unavailable" : o.errorMessage.textContent = t.errorKeyText, e.setStyles(o.errorMessage, { display: "block" })) })) } catch (t) { console.log("An error occurred while creating basilisk captcha", t) } }, i.prototype.getResult = function () { var t, e, i; return null !== (i = null === (e = null === (t = this.challengeData) || void 0 === t ? void 0 : t.data) || void 0 === e ? void 0 : e.captcha_response) && void 0 !== i ? i : null }, i.prototype.observeDataThemeAttribute = function () { var t = this; new MutationObserver((function (e) { for (var i = 0, n = e; i < n.length; i++) { var o = n[i]; if ("attributes" === o.type && "data-theme" === o.attributeName) if ("dark" === o.target.getAttribute("data-theme")) { if (t.isDark) return; t.isDark = !0, t.changeElementsToDark() } else { if (!t.isDark) return; t.isDark = !1, t.changeElementsToLight() } } })).observe(this.element, { attributes: !0, attributeFilter: ["data-theme"] }) }, i.prototype.fetchData = function (e, i, n) { return void 0 === i && (i = {}), o = this, r = void 0, s = function () { var o, r, a, s = this; return function (t, e) { var i, n, o, r, a = { label: 0, sent: function () { if (1 & o[0]) throw o[1]; return o[1] }, trys: [], ops: [] }; return r = { next: s(0), throw: s(1), return: s(2) }, "function" == typeof Symbol && (r[Symbol.iterator] = function () { return this }), r; function s(s) { return function (l) { return function (s) { if (i) throw new TypeError("Generator is already executing."); for (; r && (r = 0, s[0] && (a = 0)), a;)try { if (i = 1, n && (o = 2 & s[0] ? n.return : s[0] ? n.throw || ((o = n.return) && o.call(n), 0) : n.next) && !(o = o.call(n, s[1])).done) return o; switch (n = 0, o && (s = [2 & s[0], o.value]), s[0]) { case 0: case 1: o = s; break; case 4: return a.label++, { value: s[1], done: !1 }; case 5: a.label++, n = s[1], s = [0]; continue; case 7: s = a.ops.pop(), a.trys.pop(); continue; default: if (!((o = (o = a.trys).length > 0 && o[o.length - 1]) || 6 !== s[0] && 2 !== s[0])) { a = 0; continue } if (3 === s[0] && (!o || s[1] > o[0] && s[1] < o[3])) { a.label = s[1]; break } if (6 === s[0] && a.label < o[1]) { a.label = o[1], o = s; break } if (o && a.label < o[2]) { a.label = o[2], a.ops.push(s); break } o[2] && a.ops.pop(), a.trys.pop(); continue }s = e.call(t, a) } catch (t) { s = [6, t], n = 0 } finally { i = o = 0 } if (5 & s[0]) throw s[1]; return { value: s[0] ? s[1] : void 0, done: !0 } }([s, l]) } } }(this, (function (l) { switch (l.label) { case 0: this.challengeData = null, l.label = 1; case 1: return l.trys.push([1, 4, , 5]), [4, fetch("".concat(t.serverUrl, "/api/").concat(e), { method: "POST", body: JSON.stringify(i) })]; case 2: if (!(o = l.sent()).ok) throw new Error("HTTP error! Status: ".concat(o.status)); return [4, o.json()]; case 3: return "Rejected" === (r = l.sent()).message && this.popup ? (this.resetSession(), [2]) : (this.challengeData = r, n(), [3, 5]); case 4: return (a = l.sent()) instanceof Error && console.log("There was a problem with the fetch operation:", a.message), this.resetSession((function () { var t; null === (t = s.spinner) || void 0 === t || t.stop() })), [3, 5]; case 5: return [2] } })) }, new ((a = void 0) || (a = Promise))((function (t, e) { function i(t) { try { l(s.next(t)) } catch (t) { e(t) } } function n(t) { try { l(s.throw(t)) } catch (t) { e(t) } } function l(e) { var o; e.done ? t(e.value) : (o = e.value, o instanceof a ? o : new a((function (t) { t(o) }))).then(i, n) } l((s = s.apply(o, r || [])).next()) })); var o, r, a, s }, i.prototype.changeElementsToLight = function () { e.setStyles(this.captcha, { backgroundColor: "white" }), e.setStyles(this.checkbox, { backgroundColor: t.lightColor, borderColor: t.secondaryBorderColor }), e.setStyles(this.humanText, { color: "black" }) }, i.prototype.changeElementsToDark = function () { e.setStyles(this.captcha, { backgroundColor: t.darkColor }), e.setStyles(this.checkbox, { backgroundColor: t.semiDarkColor, borderColor: t.primaryBorderColor }), e.setStyles(this.humanText, { color: t.lightColor }) }, i.prototype.initFont = function () { var t = this.elementsCreator.createLink(), e = this.elementsCreator.createLink(), i = this.elementsCreator.createLink(); t.rel = "preconnect", t.href = "https://fonts.googleapis.com", e.rel = "preconnect", e.href = "https://fonts.gstatic.com", e.crossOrigin = "anonymous", i.href = "https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap", i.rel = "stylesheet", document.head.append(t, e, i) }, i.prototype.initCaptcha = function () { var t; this.initFont(), this.captcha = this.elementsCreator.createCaptcha(this.isDark), this.checkbox = this.elementsCreator.createCheckbox(this.isDark), this.checked = this.elementsCreator.createChecked(), this.humanText = this.elementsCreator.createHumanText(this.isDark), this.humanBlock = this.elementsCreator.createHumanBlock(), this.humanBlock.append(this.checkbox, this.humanText), this.errorMessage = this.elementsCreator.createErrorMessage(), this.captchaValue = this.elementsCreator.createCaptchaValue(), this.captcha.append(this.errorMessage, this.humanBlock), null === (t = this.element) || void 0 === t || t.append(this.captcha, this.captchaValue), e.setStyles(this.element, { userSelect: "none" }) }, i.prototype.initPopup = function () { var t, e = this; this.popup = this.elementsCreator.createPopup(), this.popup.close(), this.popupContent = this.elementsCreator.createPopupContent(this.isDark), this.popup.append(this.popupContent), this.canvasWrapper = this.elementsCreator.createCanvasWrapper(), this.canvas = this.elementsCreator.createCanvas({ width: "100%" }), this.canvasCtx = this.canvas.getContext("2d"), this.challengePuzzle = this.elementsCreator.createChallengePuzzle(), this.challengePuzzleCtx = this.challengePuzzle.getContext("2d"), this.result = this.elementsCreator.createResult(), this.canvasWrapper.append(this.canvas, this.challengePuzzle, this.result), this.sliderContainer = this.elementsCreator.createSlideContainer(this.isDark), this.slider = this.elementsCreator.createSlider(), this.sliderText = this.elementsCreator.createSliderText(), this.slider.append(this.elementsCreator.createSliderIcon()), this.sliderContainer.append(this.slider, this.sliderText), this.challenge = this.elementsCreator.createChallenge((function () { var t; e.isPopupCanBeClosed = !0, null === (t = e.spinner) || void 0 === t || t.stop() })), this.challenge.append(this.canvasWrapper, this.sliderContainer); var i = this.elementsCreator.createControlPanel(); this.closeIcon = this.elementsCreator.createControlIcon("-167px", "-195px"), this.refreshIcon = this.elementsCreator.createControlIcon("-279px", "-307px"), this.infoIcon = this.elementsCreator.createControlIcon("-223px", "-251px"), i.append(this.closeIcon, this.refreshIcon, this.infoIcon); var n = this.elementsCreator.createFooter(); n.append(i), null === (t = document.querySelector("body")) || void 0 === t || t.append(this.popup), this.popupContent.append(this.challenge, n), this.initSlideCaptchaImg(), this.bindChallengeEvents() }, i.prototype.initSlideCaptchaImg = function () { var e, i, n, o, r = this; try { var a = new Image; a.crossOrigin = "Anonymous", a.onload = function () { var e; null === (e = r.canvasCtx) || void 0 === e || e.drawImage(a, 0, 0, t.canvasWidth, t.canvasHeight) }, a.src = null === (i = null === (e = this.challengeData) || void 0 === e ? void 0 : e.data) || void 0 === i ? void 0 : i.background_url; var s = new Image; s.crossOrigin = "Anonymous", s.onload = function () { var e, i, n, o, a; r.challengePuzzle && (null === (i = null === (e = r.challengeData) || void 0 === e ? void 0 : e.data) || void 0 === i ? void 0 : i.slide_y) && (r.challengePuzzle.width = t.puzzleSize, r.challengePuzzle.height = s.height, r.challengePuzzle.style.top = "".concat((null === (o = null === (n = r.challengeData) || void 0 === n ? void 0 : n.data) || void 0 === o ? void 0 : o.slide_y) + 1, "px"), null === (a = r.challengePuzzleCtx) || void 0 === a || a.drawImage(s, 0, 0, t.puzzleSize, s.height)) }, s.src = null === (o = null === (n = this.challengeData) || void 0 === n ? void 0 : n.data) || void 0 === o ? void 0 : o.slide_url, this.sliderText && (this.sliderText.textContent = t.barText) } catch (t) { console.log("Image loading error"), this.resetSession() } }, i.prototype.handleDragStart = function (t) { this.challengeData && (this.isPopupCanBeClosed = !1, t instanceof MouseEvent && (this.startX = t.clientX, this.startY = t.clientY), window.TouchEvent && t instanceof TouchEvent && t.touches.length > 0 && (this.startX = t.touches[0].clientX, this.startY = t.touches[0].clientY), this.isMouseDown = !0, e.setStyles(this.slider, { cursor: "grabbing" }), document.addEventListener("mousemove", this.boundHandleDragMove), document.addEventListener("mouseup", this.boundHandleDragEnd), document.addEventListener("touchmove", this.boundHandleDragMove), document.addEventListener("touchend", this.boundHandleDragEnd)) }, i.prototype.handleDragMove = function (i) { var n; if (this.isMouseDown) { var o = this.getEventCoords(i), r = o.moveX, a = o.moveY; r < 8 || r > t.canvasWidth - (null === (n = this.slider) || void 0 === n ? void 0 : n.clientWidth) - 8 || (e.setStyles(this.challengePuzzle, { left: "".concat(r, "px") }), e.setStyles(this.slider, { left: "".concat(r, "px") }), this.addCoordsToTrails(r, a)) } }, i.prototype.getEventCoords = function (t) { var e = 0, i = 0; return t instanceof MouseEvent && (e = t.clientX, i = t.clientY), window.TouchEvent && t instanceof TouchEvent && t.touches.length > 0 && (e = t.touches[0].clientX, i = t.touches[0].clientY), { moveX: e - this.startX, moveY: i - this.startY } }, i.prototype.handleDragEnd = function (i) { var n, r, a = this; if (!this.isMouseDown) return !1; if (0 === this.trailX.length) { var s = window.TouchEvent && i instanceof TouchEvent, l = this.getEventCoords(i), c = l.moveX, h = l.moveY; this.addCoordsToTrails(s ? 0 : c, s ? 0 : h) } e.setStyles(this.slider, { cursor: "pointer" }), this.isMouseDown = !1, null === (n = this.slider) || void 0 === n || n.removeEventListener("mousedown", this.boundHandleDragStart), document.removeEventListener("mousemove", this.boundHandleDragMove), document.removeEventListener("mouseup", this.boundHandleDragEnd), null === (r = this.slider) || void 0 === r || r.removeEventListener("touchstart", this.boundHandleDragStart), document.removeEventListener("touchmove", this.boundHandleDragMove), document.removeEventListener("touchend", this.boundHandleDragEnd); var u = o(o({}, this.initRequestBody), { captcha_id: this.captcha_id, trail_x: this.trailX, trail_y: this.trailY }); this.fetchData(t.slideVerify, u, (function () { var e, i; (null === (e = a.challengeData) || void 0 === e ? void 0 : e.success) ? (a.sliderText && (a.sliderText.textContent = ""), null === (i = a.result) || void 0 === i || i.success(), a.isSliderCaptcha = !1, setTimeout((function () { a.initIconCaptcha() }), t.standartTimeout)) : a.createErrorAnimation() })) }, i.prototype.isMobile = function () { return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) }, i.prototype.getCanvasClicks = function (t) { var e, i = null === (e = this.canvas) || void 0 === e ? void 0 : e.getBoundingClientRect(); return { clickX: t.clientX - i.left, clickY: t.clientY - i.top } }, i.prototype.addCoordsToTrails = function (t, e) { var i = Date.now(); i > this.lastCallTimestamp && (this.trailX.push({ timestamp: i, coord: t }), this.trailY.push({ timestamp: i, coord: e }), this.lastCallTimestamp = i) }, i.prototype.trackingPopupContentEvents = function (t) { var e = this.getCanvasClicks(t), i = e.clickX, n = e.clickY; this.addCoordsToTrails(i, n) }, i.prototype.handleCanvasClick = function (e) { var i, n, o = this.getCanvasClicks(e), r = o.clickX, a = o.clickY; 0 === this.trailX.length && (this.isMobile() ? null === (i = this.popupContent) || void 0 === i || i.addEventListener("click", this.boundTrackingPopupContentEvents) : (this.addCoordsToTrails(r, a), null === (n = this.popupContent) || void 0 === n || n.addEventListener("mousemove", this.boundTrackingPopupContentEvents))); for (var s = t.clickCircleRadius, l = !1, c = 0; c < this.clickedIcons.length; c++) { var h = this.clickedIcons[c], u = r - h.x, d = a - h.y; if (u * u + d * d <= s * s) { this.clickedIcons.splice(c, 1), l = !0; break } } !l && this.clickedIcons.length < t.totalIconsAmount ? (this.clickedIcons.push({ x: r, y: a }), this.drawIcons()) : l && this.drawIcons() }, i.prototype.handleVerifyButtonClick = function (i) { var n, r, a, s, l = this; if (null === (n = this.verifyButton) || void 0 === n || n.removeEventListener("click", this.boundVerifyButtonClick), null === (r = this.canvas) || void 0 === r || r.removeEventListener("click", this.boundHandleCanvasClick), this.trackingPopupContentEvents(i), null === (a = this.popupContent) || void 0 === a || a.removeEventListener("click", this.boundTrackingPopupContentEvents), null === (s = this.popupContent) || void 0 === s || s.removeEventListener("mousemove", this.boundTrackingPopupContentEvents), this.isPopupCanBeClosed = !1, this.clickedIcons.length === t.totalIconsAmount) { var c = o(o({}, this.initRequestBody), { captcha_id: this.captcha_id, coords: this.clickedIcons, trail_x: this.trailX, trail_y: this.trailY }); this.fetchData(t.iconsVerify, c, (function () { var i; (null === (i = l.challengeData) || void 0 === i ? void 0 : i.success) ? e.createDelayAnimation(t.shortTimeout, (function () { var e; null === (e = l.result) || void 0 === e || e.success(), setTimeout((function () { var e, i, n, o, r, a, s; (null === (i = null === (e = l.challengeData) || void 0 === e ? void 0 : e.data) || void 0 === i ? void 0 : i.captcha_response) ? (l.verified = !0, null === (n = l.popup) || void 0 === n || n.close(), l.resetOneMinTimout(), null === (o = l.humanBlock) || void 0 === o || o.addEventListener("click", l.boundHandleHumanClick), null === (r = l.checkbox) || void 0 === r || r.append(l.checked), null === (a = l.challenge) || void 0 === a || a.hide(), null === (s = l.captchaValue) || void 0 === s || s.setAttribute("value", l.challengeData.data.captcha_response), l.dispatch(l.challengeData.data.captcha_response), l.threeMinsTimoutId = setTimeout((function () { l.resetSession(), l.resetThreeMinsTimout() }), t.threeMinutsTimeout)) : l.resetSession() }), t.standartTimeout) })) : l.createErrorAnimation() })) } else this.createErrorAnimation() }, i.prototype.resetOneMinTimout = function () { this.oneMinTimoutId && (clearTimeout(this.oneMinTimoutId), this.oneMinTimoutId = null) }, i.prototype.resetThreeMinsTimout = function () { this.threeMinsTimoutId && (clearTimeout(this.threeMinsTimoutId), this.threeMinsTimoutId = null) }, i.prototype.reset = function () { var t, e, i, n, o, r, a; this.resetOneMinTimout(), this.resetThreeMinsTimout(), this.verified = !1, this.challengeData = null, this.captcha_id = null, this.isSliderCaptcha = !0, this.trailX = [], this.trailY = [], this.clickedIcons = [], null === (t = this.checked) || void 0 === t || t.remove(), this.dispatch(null), null === (e = this.humanBlock) || void 0 === e || e.addEventListener("click", this.boundHandleHumanClick), this.popup && (null === (i = this.spinner) || void 0 === i || i.stop(), null === (n = this.popup) || void 0 === n || n.close(), null === (o = this.challenge) || void 0 === o || o.hide(), null === (r = this.popup) || void 0 === r || r.remove(), null === (a = this.challenge) || void 0 === a || a.remove()) }, i.prototype.resetSession = function (t) { void 0 === t && (t = function () { }), this.reset(), e.setStyles(this.errorMessage, { display: "block" }), e.setStyles(this.checkbox, { borderColor: "red" }), t() }, i.prototype.createErrorAnimation = function () { var i = this; e.createDelayAnimation(t.shortTimeout, (function () { var n, o, r = null === (n = i.popup) || void 0 === n ? void 0 : n.firstChild, a = null, s = function (n) { a || (a = n); var o = n - a; if (o <= 400) { var l = o / 400, c = 0; l < .125 ? c = -5 : l < .375 ? c = 5 : l < .625 ? c = -5 : l < .875 && (c = 5), e.setStyles(r, { marginLeft: "".concat(c, "px") }), requestAnimationFrame(s) } else e.setStyles(r, { marginLeft: "0" }), setTimeout((function () { var e; null === (e = i.result) || void 0 === e || e.hide(), setTimeout((function () { i.isSliderCaptcha ? i.resetSlideCaptcha() : i.resetIconCaptcha() }), t.standartTimeout) }), t.standartTimeout) }; requestAnimationFrame(s), null === (o = i.result) || void 0 === o || o.error() })) }, i.prototype.clearCanvas = function () { var e; null === (e = this.canvasCtx) || void 0 === e || e.clearRect(0, 0, t.canvasWidth, t.canvasHeight) }, i.prototype.drawIcons = function () { var e = this; this.clearCanvas(); var i = this.canvasCtx; this.clickedIcons.forEach((function (n) { var o = n.x, r = n.y; if (i) { i.fillStyle = t.blueColor, i.beginPath(), i.arc(o, r, t.clickCircleRadius, 0, 2 * Math.PI), i.fill(), i.lineWidth = 3, i.strokeStyle = "white", i.stroke(), i.font = "16px Arial", i.fillStyle = "white"; var a = e.clickedIcons.indexOf(n) + 1, s = i.measureText("".concat(a)).width; i.fillText("".concat(a), o - s / 2, r + 6.4) } })) }, i.prototype.initializeIconsChallenge = function () { var t, i; (null === (i = null === (t = this.challengeData) || void 0 === t ? void 0 : t.data) || void 0 === i ? void 0 : i.background_url) && e.setStyles(this.canvasWrapper, { backgroundImage: "url(".concat(this.challengeData.data.background_url, ")") }), this.clearCanvas() }, i.prototype.setCheckboxBorderStyles = function () { e.setStyles(this.checkbox, { borderColor: this.isDark ? t.primaryBorderColor : t.secondaryBorderColor }) }, i.prototype.bindInitialsEvents = function () { var i, n, o, r = this; null === (i = this.checkbox) || void 0 === i || i.addEventListener("mouseover", (function () { e.setStyles(r.checkbox, { borderColor: t.blueColor }) })), null === (n = this.checkbox) || void 0 === n || n.addEventListener("mouseleave", (function () { r.setCheckboxBorderStyles() })), null === (o = this.humanBlock) || void 0 === o || o.addEventListener("click", this.boundHandleHumanClick) }, i.prototype.handleHumanBlockClick = function () { var i, n, o = this; this.verified || (null === (i = this.humanBlock) || void 0 === i || i.removeEventListener("click", this.boundHandleHumanClick), this.setCheckboxBorderStyles(), e.setStyles(this.errorMessage, { display: "none" }), this.checkbox && (this.spinner || (this.spinner = this.elementsCreator.createSpinner(this.checkbox)), null === (n = this.spinner) || void 0 === n || n.start(), this.resetOneMinTimout()), this.fetchData(t.createChallenge, this.initRequestBody, (function () { var i, n; (null === (i = o.challengeData) || void 0 === i ? void 0 : i.success) ? (o.captcha_id = null === (n = o.challengeData.data) || void 0 === n ? void 0 : n.captcha_id, o.captcha_id ? (o.initPopup(), e.createDelayAnimation(t.shortTimeout, (function () { var e, i; null === (e = o.popup) || void 0 === e || e.open(), null === (i = o.challenge) || void 0 === i || i.show(), o.oneMinTimoutId = setTimeout((function () { o.resetSession() }), t.oneMinuteTimeout) }))) : o.resetSession((function () { var t; null === (t = o.spinner) || void 0 === t || t.stop() }))) : o.resetSession((function () { var t; null === (t = o.spinner) || void 0 === t || t.stop() })) }))) }, i.prototype.bindChallengeEvents = function () { var i, n, o, r, a, s, l, c, h = this; null === (i = this.refreshIcon) || void 0 === i || i.addEventListener("click", (function () { h.isPopupCanBeClosed && (h.isPopupCanBeClosed = !1, h.isSliderCaptcha ? h.resetSlideCaptcha() : h.resetIconCaptcha()) })), null === (n = this.closeIcon) || void 0 === n || n.addEventListener("click", (function () { h.isPopupCanBeClosed && h.reset() })), null === (o = this.popup) || void 0 === o || o.addEventListener("click", (function (t) { h.isPopupCanBeClosed && t.currentTarget === t.target && h.reset() })), null === (r = this.infoIcon) || void 0 === r || r.addEventListener("click", (function () { window.open(t.videoManualUrl, "_blank") })), null === (a = this.slider) || void 0 === a || a.addEventListener("mousedown", this.boundHandleDragStart), null === (s = this.slider) || void 0 === s || s.addEventListener("touchstart", this.boundHandleDragStart), null === (l = this.slider) || void 0 === l || l.addEventListener("mouseover", (function () { e.setStyles(h.slider, { backgroundColor: "#24AFFF" }), h.isMouseDown && e.setStyles(h.slider, { cursor: "grabbing" }) })), null === (c = this.slider) || void 0 === c || c.addEventListener("mouseleave", (function () { e.setStyles(h.slider, { backgroundColor: "#009EFB" }) })) }, i.prototype.initIconCaptcha = function () { var i, n = this; null === (i = this.spinner) || void 0 === i || i.start(); var r = o(o({}, this.initRequestBody), { captcha_id: this.captcha_id }); this.fetchData(t.iconsChallenge, r, (function () { var i, o; null === (i = n.challenge) || void 0 === i || i.hide(), null === (o = n.result) || void 0 === o || o.hide(), setTimeout((function () { var t, i, o, r, a, s, l, c; n.clearCanvas(), n.trailX = [], n.trailY = [], e.setStyles(n.popupContent, { height: "476px", transition: "height 0.5s cubic-bezier(0.4, 2.5, 0.4, 0.6)" }), null === (t = n.challenge) || void 0 === t || t.children[1].remove(), null === (i = n.challengePuzzle) || void 0 === i || i.remove(), n.initializeIconsChallenge(), n.verifyButton = n.elementsCreator.createVerifyButton(), n.order = n.elementsCreator.createOrder(n.isDark); var h = null === (r = null === (o = n.challengeData) || void 0 === o ? void 0 : o.data) || void 0 === r ? void 0 : r.icons_order; h && n.order.showIcons(h), null === (a = n.challenge) || void 0 === a || a.prepend(n.order), null === (s = n.challenge) || void 0 === s || s.append(n.verifyButton), null === (l = n.challenge) || void 0 === l || l.show(), null === (c = n.canvas) || void 0 === c || c.addEventListener("click", n.boundHandleCanvasClick), n.verifyButton.addEventListener("click", n.boundVerifyButtonClick) }), t.mediumTimeout) })) }, i.prototype.resetSlideCaptcha = function () { var i, n = this; null === (i = this.spinner) || void 0 === i || i.start(); var r = o(o({}, this.initRequestBody), { captcha_id: this.captcha_id }); this.fetchData(t.slideChallenge, r, (function () { var i; null === (i = n.challenge) || void 0 === i || i.hide(), setTimeout((function () { var i, o, r, a, s, l; n.trailX = [], n.trailY = [], e.setStyles(n.slider, { left: "".concat(t.sliderStartPosition, "px") }), e.setStyles(n.challengePuzzle, { left: "".concat(t.sliderStartPosition, "px") }), n.challengePuzzle && (n.challengePuzzle.width = t.canvasWidth), n.clearCanvas(), null === (i = n.challengePuzzleCtx) || void 0 === i || i.clearRect(0, 0, t.canvasWidth, t.canvasHeight), null === (o = n.sliderText) || void 0 === o || o.setAttribute("data-text", null === (r = n.sliderText) || void 0 === r ? void 0 : r.textContent), n.sliderText && (n.sliderText.textContent = t.loadingText), n.initSlideCaptchaImg(), null === (a = n.challenge) || void 0 === a || a.show(), null === (s = n.slider) || void 0 === s || s.addEventListener("mousedown", n.boundHandleDragStart), null === (l = n.slider) || void 0 === l || l.addEventListener("touchstart", n.boundHandleDragStart) }), t.mediumTimeout) })) }, i.prototype.resetIconCaptcha = function () { var e, i = this; null === (e = this.spinner) || void 0 === e || e.start(); var n = o(o({}, this.initRequestBody), { captcha_id: this.captcha_id }); this.fetchData(t.iconsChallenge, n, (function () { var e; null === (e = i.challenge) || void 0 === e || e.hide(), setTimeout((function () { var t, e, n, o, r, a; i.trailX = [], i.trailY = [], i.clickedIcons = [], null === (t = i.order) || void 0 === t || t.showIcons(null === (n = null === (e = i.challengeData) || void 0 === e ? void 0 : e.data) || void 0 === n ? void 0 : n.icons_order), i.initializeIconsChallenge(), null === (o = i.challenge) || void 0 === o || o.show(), null === (r = i.canvas) || void 0 === r || r.addEventListener("click", i.boundHandleCanvasClick), null === (a = i.verifyButton) || void 0 === a || a.addEventListener("click", i.boundVerifyButtonClick) }), t.mediumTimeout) })) }, i }(), a = document.querySelector(".basilisk_captcha"); window.BasiliskCaptcha = a ? new r(a) : r })();