(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[17],{129:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e,t,a){return Math.min(Math.max(e,t),a)}},207:function(e,t,a){"use strict";a.d(t,"b",(function(){return W})),a.d(t,"e",(function(){return Y})),a.d(t,"a",(function(){return h})),a.d(t,"f",(function(){return z})),a.d(t,"d",(function(){return Q})),a.d(t,"c",(function(){return X}));var n=a(17),i=a(3),r=a(162),s=a(21),o=a(10),u=a(24),c=a(25),l=a(129),m="crashBetAmt",d="crashPayout",h="crashBet_",f=a(1),b=a(4),v=a(67),y=a(209),g=a(32),p=a(99),S=a(176),_=function(){function e(t,a){var n=this;Object(u.a)(this,e),this.manager=void 0,this.removeCallBacks=[],this.setReady=void 0,this.tick=0,this.closeSocket=function(){r.h.close("offline",!0)},this.init=Object(b.a)(Object(f.a)().mark((function e(){var t,a;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.manager.config.user,a=function(){var e=Object(b.a)(Object(f.a)().mark((function e(){var a,n;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,Object(y.a)(v.c.get("/account/get-socket-token"));case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0={data:{socket_token:""}};case 7:n=e.t0,[{type:"initialization",socket_token:(null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.socket_token)||""},{type:"get_current_bets"},{type:"get_coin_configuration"}].forEach((function(e){r.h.send(e)}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.h.open(a),r.h.listener(),r.h.dispatch(S.a),n.socketListener();case 6:case"end":return e.stop()}}),e)}))),this.socketListener=function(){var e=function(e){n.manager.setValue("round",e)},t=function(e){n.manager.setValue("playableStatus",e)},a=n.manager,i=a.config,r=a.state,s=r.auto,o=r.bets,u=r.config;r.manual;S.b.managerListener=function(a){if(a.error){var c=s.isStarted;localStorage.removeItem(h),g.b.error({message:a.error,timeOut:c?1/0:8e3}),"play"===n.manager.betManager.state.playStatus&&n.manager.betManager.cashout(),n.manager.setValue("autoStarted",!1),t("noPlay")}switch(a.method){case"update_coin_parameters":default:break;case"crashed":e("crashed");var l=a.id,m=a.server_seed,d=a.value;n.manager.setValue("history",{crash_point:d+"",id:l+"",seed:m});break;case"previous_rounds":n.manager.setValue("history",a.rounds.map((function(e){return{crash_point:e.crash_point,id:e.id,seed:e.seed}})).reverse());break;case"new_round":n.manager.tableManager.clearBets(),e("startNewRound");break;case"update_value":e("playRound");break;case"bet_played":var f;if(!a.error)"waitForExitFromBetAfterStartedRound"!==n.manager.getBetStateValue("playStatus")&&t("play"),g.b.success("Bet placed"),null===(f=i.coin)||void 0===f||f.updateBalance(Number(a.balance),u.betCoin);break;case"bet_cashedout_update":if(!a.error){var b=a.at,v=a.coin,y=a.profit,S=a.user_id,_=o.currentBets[S];if(_){var k=_.bet_amt,O=_.user_name;n.manager.tableManager.updateBets({bet_amt:k,coin:v,user_id:S,user_name:O,cashed_out_at:b+"",profit:Number(y)})}var w=n.manager.config.user;if(null!==w&&void 0!==w&&w.user_id&&w.user_id===S){localStorage.removeItem(h),t("noPlay"),s.params.values.winStatus="win";var A,B=i.coin.list.find((function(e){return e.symbol===v}));if(B)null===(A=i.coin)||void 0===A||A.updateBalance(Number(B.balance)+Number(y),v)}}break;case"bet_cashedout":var L;if(!a.error)null===(L=i.coin)||void 0===L||L.updateBalance(Number(a.balance),u.betCoin);break;case"new_bet_finalized":var N=Number(a.profit);p.a.addBet({amount:Number(a.bet_amt),profit:N}),s.params.values.profit+=N;break;case"new_bet":var E=a.bet_amt,P=a.coin,R=a.user_id,j=a.user_name;n.manager.tableManager.updateBets({bet_amt:E,coin:P,user_id:R,user_name:j});break;case"current_bets":if(Array.isArray(a.bets))console.error("crash: get current_bets as array",{wsServerData:a});else{var V,C=a.bets;r.bets.currentBets=C,n.manager.tableManager.updateBets(Object.values(C));var T=C[(null===(V=i.user)||void 0===V?void 0:V.user_id)||""];if(T&&!T.profit){n.manager.setValue("playableStatus","play");try{var M={coin:T.coin,value:T.bet_amt};localStorage.setItem(h,JSON.stringify(M))}catch(x){console.error(x)}}}}},S.b.coinConfigListener=function(e){var t=e.coin_config;i.coinsLimitsConfig=t,n.setReady()},n.removeCallBacks.push((function(){S.b.managerListener=function(){},S.b.coinConfigListener=function(){}})),S.b.tickListener=function(){n.tick<100?n.tick++:100===n.tick&&(n.tick++,n.setReady(),delete S.b.tickListener)}},this.manager=t,this.setReady=a,window.addEventListener("online",this.init),window.addEventListener("offline",this.closeSocket),this.removeCallBacks.push((function(){window.removeEventListener("online",n.init),window.removeEventListener("offline",n.closeSocket)}))}return Object(c.a)(e,[{key:"destroy",value:function(){this.removeCallBacks.forEach((function(e){return e()})),r.h.close("",!0)}}]),e}(),k=a(43),O=a(87),w=a.n(O),A="CHANGE_AUTO_STARTED_EVENT",B="CHANGE_BET_AMOUNT_EVENT",L="CHANGE_AUTO_OPEN_EVENT",N="CHANGE_PAYOUT_EVENT",E="CHANGE_PLAY_STATUS_EVENT",P="CHANGE_ROUND_EVENT",R="CHANGE_AUTO_RADIO_EVENT",j="CHANGE_AUTO_LIMIT_EVENT",V="CHANGE_AUTO_BET_PERCENT_EVENT",C="HISTORY_EVENT",T="HISTORY_MODAL_EVENT",M=function(){function e(t,a){var n=this;Object(u.a)(this,e),this.manager=void 0,this.betManager=void 0,this.emitter=void 0,this.setBetAmount=function(e){var t,a=n.manager.state,i=a.isLoad;(a.manual.betAmount=e,i)&&localStorage.setItem(m,JSON.stringify({coin:(null===(t=n.manager.config.coin.selected)||void 0===t?void 0:t.symbol)||"",value:e.toFixed(8)}));n.emitter.emit(B,e)},this.listenBetAmount=function(e){return n.createListener(e,B)},this.setPayout=function(e){n.manager.state.manual.payout=e,localStorage.setItem(d,"".concat(e)),n.emitter.emit(N,e)},this.listenPayout=function(e){return n.createListener(e,N)},this.setAuto=function(e,t){n.manager.state.auto[t]=e;var a="isOpen"===t?L:A;n.emitter.emit(a,e)},this.autoListen=function(e,t){var a="isOpen"===t?L:A;return n.createListener(e,a)},this.setRound=function(e){var t=n.betManager.state;t.round!==e&&(t.round=e,n.emitter.emit(P,e))},this.roundListen=function(e){return n.createListener(e,P)},this.setPlayableStatus=function(e){n.betManager.state.playStatus=e,n.emitter.emit(E,e)},this.listenPlayableStatus=function(e){return n.createListener(e,E)},this.setAutoRadio=function(e){var t=e.field,a=e.value;n.manager.state.auto.params[t].value=a,n.emitter.emit(R,{value:a,field:t})},this.listenAutoRadio=function(e){return n.createListener(e,R)},this.setLimit=function(e){var t=e.field,a=e.value;n.manager.state.auto.params.limits[t]=a,n.emitter.emit(j,e)},this.listenLimit=function(e){return n.createListener(e,j)},this.setBetPercent=function(e){var t=e.field,a=e.value;n.manager.state.auto.params[t].betByPercent=a,n.emitter.emit(V,e)},this.listenBetPercent=function(e){return n.createListener(e,V)},this.setHistory=function(e){var t=n.manager.state.bets.history;Array.isArray(e)?t.unshift.apply(t,Object(k.a)(e)):t.unshift(e),t.length=10,n.emitter.emit(C,t)},this.listenHistory=function(e){return n.createListener(e,C)},this.openModal=function(e){n.emitter.emit(T,e)},this.modalListener=function(e){return n.createListener(e,T)},this.setters={autoOpen:function(e){return n.setAuto(e,"isOpen")},autoStarted:function(e){return n.setAuto(e,"isStarted")},betAmount:this.setBetAmount,payout:this.setPayout,autoRadio:this.setAutoRadio,autoBetPercent:this.setBetPercent,autoLimits:this.setLimit,playableStatus:this.setPlayableStatus,round:this.setRound,history:this.setHistory},this.listeners={autoOpen:function(e){return n.autoListen(e,"isOpen")},autoStarted:function(e){return n.autoListen(e,"isStarted")},betAmount:this.listenBetAmount,payout:this.listenPayout,autoRadio:this.listenAutoRadio,autoBetPercent:this.listenBetPercent,autoLimits:this.listenLimit,playableStatus:this.listenPlayableStatus,round:this.roundListen,history:this.listenHistory,historyModal:this.modalListener},this.manager=t,this.betManager=a,this.emitter=new w.a}return Object(c.a)(e,[{key:"createListener",value:function(e,t){var a=this;return this.emitter.addListener(t,e),function(){a.emitter.removeListener(t,e)}}},{key:"destroy",value:function(){this.emitter.removeAllListeners()}}]),e}(),x=a(188),F=function(){function e(t){var a=this;Object(u.a)(this,e),this.manager=void 0,this.removeCallBacks=[],this.state={playStatus:"noPlay",round:"loading"},this.init=function(){var e=a.manager.listenValue.call(a.manager,"round",a.updateRound);a.removeCallBacks.push(e)},this.setPlayStatus=function(e){a.manager.setValue("playableStatus",e)},this.updateRound=function(e){var t=a.manager.state,n=t.auto,i=t.manual.betAmount,r=a.state.playStatus;switch(e){case"crashed":"play"===r&&(a.setPlayStatus("noPlay"),p.a.addBet({amount:i,profit:-i}),n.params.values.profit-=i,n.params.values.winStatus="loss"),n.isStarted&&a.autoReact(),a.removeLocalValue();case"playRound":switch(r){case"waitForExitFromBetAfterStartedRound":a.cashout();break;case"waitForServerAnswer":a.removeLocalValue(),a.setPlayStatus("noPlay")}break;case"startNewRound":if("waitForNewRound"===r)a.makeABet(),a.setPlayStatus("waitForServerAnswer")}},this.click=function(){var e=a.state,t=e.playStatus,n=e.round,i=a.manager.state,r=i.auto,s=i.manual;if(r.isOpen)if(r.isStarted)switch(a.manager.setValue("autoStarted",!1),n){case"startNewRound":"play"!==t&&"waitForServerAnswer"!==t||a.setPlayStatus("waitForExitFromBetAfterStartedRound");break;case"playRound":if("play"===t)a.cashout();else a.setPlayStatus("noPlay")}else{a.manager.setValue("autoStarted",!0);var o=r.params.values;switch(o.baseBet=s.betAmount,o.betNumber=0,o.profit=0,delete o.winStatus,n){case"startNewRound":"noPlay"===t&&(a.makeABet(),a.setPlayStatus("waitForServerAnswer"));break;case"crashed":case"playRound":a.setPlayStatus("waitForNewRound")}}else switch(n){case"startNewRound":if("noPlay"===t)a.makeABet(),a.setPlayStatus("waitForServerAnswer");break;case"crashed":case"playRound":switch(t){case"play":a.cashout();break;case"noPlay":a.setPlayStatus("waitForNewRound");break;case"waitForNewRound":a.setPlayStatus("noPlay")}}},this.manager=t}return Object(c.a)(e,[{key:"removeLocalValue",value:function(){localStorage.removeItem(h)}},{key:"cashout",value:function(){this.removeLocalValue(),r.h.send({type:"cashout_bet"}),this.setPlayStatus("waitForServerAnswer")}},{key:"makeABet",value:function(){var e,t,a=this.manager.config.coin,n=this.manager.state,i=n.config,s=n.manual,o=s.betAmount,u=s.payout;r.h.send({type:"place_bet",bet_amt:o.toFixed(8),coin:null===a||void 0===a||null===(e=a.selected)||void 0===e?void 0:e.symbol,auto_cashout:u+""}),i.betCoin=(null===a||void 0===a||null===(t=a.selected)||void 0===t?void 0:t.symbol)||"";try{var c,l={coin:(null===a||void 0===a||null===(c=a.selected)||void 0===c?void 0:c.symbol)||"",value:o};localStorage.setItem(h,JSON.stringify(l))}catch(m){console.error(m,"betAmt:",o,"coin:",a)}}},{key:"autoReact",value:function(){var e=this,t=this.manager.config,a=t.coin,n=t.coinsLimitsConfig,i=this.manager.state,r=i.auto,s=i.manual,o=r.params.values,u=function(){e.setPlayStatus("noPlay"),e.manager.setValue("autoStarted",!1)};if(r.isStarted&&r.isOpen){this.setPlayStatus("waitForNewRound");var c=o.winStatus;if(c){o.betNumber+=1;var m=r.params["win"===c?"onWin":"onLoss"],d=m.betByPercent;switch(m.value){case"raise":var h=Number(s.betAmount)+Number(s.betAmount)*(Number(d)/100),f=a.selected||{},b=f.balance,v=void 0===b?0:b,y=f.symbol,p=(n||{})[void 0===y?"":y],S=p.maximum_bet,_=void 0===S?"1":S,k=p.minimum_bet,O=void 0===k?"0":k,w=Number(_);if(h>v)g.b.warning({message:"Stop Auto: Increased value exceeds the balance",timeOut:1/0}),u();else if(h<+O||h>w)g.b.warning({message:"Stop Auto: The Raised Bet Amount should be ".concat(h>w?"lower than "+_:"greater than "+O),timeOut:1/0}),u();else{var A=Object(l.a)(h,Number(O),w);this.manager.setValue("betAmount",A)}break;case"toBase":this.manager.setValue("betAmount",o.baseBet);break;case"stop":u()}}else!c&&o.betNumber&&(u(),x.c.error("Crash unknown winStatus",{custom:{config:this.manager.config,state:this.manager.state,statuses:this.state,winStatus:c}}),g.b.error({message:"Something went wrong. Make sure your internet connection is stable",timeOut:1/0}));delete o.winStatus;var B=r.params.limits,L=B.numberOfBets,N=B.stopOnLoss,E=B.stopOnWin;L&&L-o.betNumber<=0&&u(),E&&E-o.profit<=0&&u(),N&&N- -1*o.profit<=0&&u()}else u()}},{key:"destroy",value:function(){this.removeCallBacks.forEach((function(e){return e()}))}}]),e}(),I="UPDATE_BETS_EVENT",H=function(){function e(t){var a=this;Object(u.a)(this,e),this.manager=void 0,this.emitter=new w.a,this.betsListener=function(e){return a.createListener(e,I)},this.manager=t}return Object(c.a)(e,[{key:"createListener",value:function(e,t){var a=this;return this.emitter.addListener(t,e),function(){a.emitter.removeListener(t,e)}}},{key:"emitBets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.manager.state.bets.currentBets;this.emitter.emit(I,e)}},{key:"clearBets",value:function(){var e=this.manager.state.bets.currentBets;Object.keys(e).forEach((function(t){delete e[t]})),this.emitBets()}},{key:"updateBets",value:function(e){var t=this.manager.state.bets.currentBets;Array.isArray(e)?e.forEach((function(e){t[e.user_id+""]=e})):t[e.user_id+""]=e,this.emitBets()}}]),e}(),U=function(){function e(t){var a=this;Object(u.a)(this,e),this.config={coin:{list:[],selected:null,updateBalance:function(){}}},this.state={auto:{isOpen:!1,isStarted:!1,params:{limits:{numberOfBets:0,stopOnLoss:0,stopOnWin:0},onLoss:{betByPercent:100,value:"toBase"},onWin:{betByPercent:0,value:"toBase"},values:{baseBet:0,profit:0,betNumber:0}}},manual:{betAmount:0,payout:2},config:{payout:{min:1.01,max:1e6},betCoin:""},bets:{currentBets:{},history:[]},isLoad:!1},this.setReady=void 0,this.listener=void 0,this.controller=void 0,this.betManager=void 0,this.tableManager=void 0,this.setReady=function(){try{var e=a.config,n=e.coin,i=e.coinsLimitsConfig,r=n.selected||{},s=r.balance,o=void 0===s?0:s,u=r.symbol,c=void 0===u?"":u,h=(i||{})[c],f=h.maximum_bet,b=h.minimum_bet,v=Number(b),y=Math.min(Number(f),o||v),g=JSON.parse(localStorage.getItem(m)||"null"),p=localStorage.getItem(d);p&&a.setValue("payout",Number(p)),(null===g||void 0===g?void 0:g.coin)===c?a.setValue("betAmount",Object(l.a)(Number(g.value),v,y)):a.setValue("betAmount",v)}catch(S){console.error(S)}a.state.isLoad=!0,t()},this.tableManager=new H(this),this.listener=new _(this,this.setReady),this.betManager=new F(this),this.controller=new M(this,this.betManager),this.betManager.init(),localStorage.removeItem(h)}return Object(c.a)(e,[{key:"updateSelectedCoin",value:function(e,t){var a=this;this.config.coin&&(this.config.coin.selected=e,this.config.coin.updateBalance=function(e,n){var i;t(e,n);var r=null===(i=a.config.coin)||void 0===i?void 0:i.list.find((function(e){return e.symbol===n}));r&&(r.balance=Number(e))})}},{key:"init",value:function(e,t){var a=this;return this.config.user=e,this.config.coin.list=t.list,this.updateSelectedCoin(t.selected,t.updateBalance),this.listener.init(),function(){a.listener.destroy()}}},{key:"destroy",value:function(){this.listener.destroy(),this.betManager.destroy(),this.controller.destroy(),localStorage.removeItem(h)}},{key:"setValue",value:function(e,t){(0,this.controller.setters[e])(t)}},{key:"listenValue",value:function(e,t){return(0,this.controller.listeners[e])(t)}},{key:"getBetStateValue",value:function(e){return this.betManager.state[e]}},{key:"buttonOnClick",value:function(){this.betManager.click()}},{key:"openModal",value:function(e){this.controller.openModal(e)}}]),e}(),G=a(0),D={manager:{}},J=Object(i.createContext)(D),W=function(e){var t=e.children,a=Object(i.useRef)(),u=Object(s.i)(),c=u.loading,l=u.user,m=Object(s.j)(),d=m.coins,h=m.selectedCoin,f=m.updateCoinBalance,b=m.isLoaded,v=Object(i.useState)(!1),y=Object(n.a)(v,2),g=y[0],p=y[1];return Object(i.useEffect)((function(){return a.current=new U((function(){return p(!0)})),function(){var e;null===(e=a.current)||void 0===e||e.destroy()}}),[]),Object(i.useEffect)((function(){var e;if(!c&&b){var t=(null===(e=a.current)||void 0===e?void 0:e.init(l,{list:d,selected:h,updateBalance:f}))||function(){return r.h.close("",!0)};return function(){t()}}}),[null===l||void 0===l?void 0:l.user_id,c,b]),Object(i.useEffect)((function(){var e;null!==h&&void 0!==h&&h.name&&b&&d.length&&(null===(e=a.current)||void 0===e||e.updateSelectedCoin(h,f))}),[null===h||void 0===h?void 0:h.name,b,d.length]),g&&a.current&&!c?Object(G.jsx)(J.Provider,{value:{manager:a.current},children:t}):Object(G.jsx)(o.LoaderWithLogo,{transparent:!0})},Y=function(){return Object(i.useContext)(J)},z=function(e){var t=Y().manager,a=Object(i.useState)(t.state.auto[e]),r=Object(n.a)(a,2),s=r[0],o=r[1];Object(i.useEffect)((function(){var a=t.listenValue("isOpen"===e?"autoOpen":"autoStarted",(function(e){o(e)}));return function(){a()}}),[]);return[s,function(a){t.setValue("isOpen"===e?"autoOpen":"autoStarted",a)}]},q=a(27),K=function(e){return(!e||e<0||e===1/0)&&(e=0),e},Q=function(e,t){var a=Number(Object(q.a)(e*t-e));return K(a),Object(q.a)(a)},X=function(e){var t=97/e;return K(t),Number(Object(q.a)(t,2))}}}]);
//# sourceMappingURL=17.0ae2a99b.chunk.js.map